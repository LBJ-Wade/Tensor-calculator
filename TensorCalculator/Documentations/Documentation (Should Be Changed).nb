(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     71045,       2026]
NotebookOptionsPosition[     65594,       1841]
NotebookOutlinePosition[     66030,       1858]
CellTagsIndexPosition[     65987,       1855]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Documentation", "Title",
 CellChangeTimes->{{3.569836781821417*^9, 3.569836785325283*^9}}],

Cell[CellGroupData[{

Cell["Installation", "Section",
 CellChangeTimes->{{3.569836801618615*^9, 3.5698368037957163`*^9}}],

Cell[TextData[{
 "Copy ",
 StyleBox["the whole \[OpenCurlyQuote]TensorCaculator\[CloseCurlyQuote] \
folder",
  FontWeight->"Bold"],
 " to ",
 StyleBox["\[OpenCurlyQuote]/*path_to_",
  FontWeight->"Bold"],
 StyleBox["Mathematica",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox["*/*version*/Addons/Applications/\[CloseCurlyQuote]",
  FontWeight->"Bold"],
 ", if you are using Linux.\n\nThat\[CloseCurlyQuote]s all!"
}], "Text",
 CellChangeTimes->{{3.5698368185373993`*^9, 3.569836953625646*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["How To Use It", "Section",
 CellChangeTimes->{{3.5698317012574463`*^9, 3.569831714894269*^9}}],

Cell[TextData[{
 "Open ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " or just type \[OpenCurlyQuote]math\[CloseCurlyQuote] in your terminal, if \
you are using Linux.\nType in ",
 StyleBox["\[OpenCurlyQuote]Get[\[OpenCurlyDoubleQuote]TensorCalculator`\
ModuleXXX`\[CloseCurlyDoubleQuote]]\[CloseCurlyQuote]",
  FontWeight->"Bold"],
 ", then theses functions are read by ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " kernel.\nAnd then, you can all these functions."
}], "Text",
 CellChangeTimes->{{3.5698317406829348`*^9, 3.569831917525278*^9}, {
  3.569836942349434*^9, 3.569836984726305*^9}, {3.569837026813508*^9, 
  3.569837073547966*^9}, {3.594800718656651*^9, 3.594800718999505*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Conventions", "Section",
 CellChangeTimes->{{3.56983824779683*^9, 3.569838251752035*^9}}],

Cell["\<\
The signature can be chosen arbitrarily.

But which are time components and which are space components? It can be \
chosen arbitrarily as you like, since the time and space components have the \
same status, as long as consisting with your signature and your metric input.\
\
\>", "Text",
 CellChangeTimes->{{3.5698382567870817`*^9, 3.569838459189517*^9}, {
   3.56983849813169*^9, 3.569838558302182*^9}, {3.569838842998177*^9, 
   3.56983897572535*^9}, {3.5698390356594276`*^9, 3.5698390785318537`*^9}, 
   3.569839177698803*^9, {3.569839229033231*^9, 3.5698392462587833`*^9}, {
   3.569839277875803*^9, 3.5698393572023478`*^9}, 3.571651532742058*^9, {
   3.5716517082578278`*^9, 3.5716517529298058`*^9}}],

Cell["\<\
Note that, when you run function XXXModule[metric], a variable will be \
generated, which is named by XXX (the XXX in the name of XXXModule[metric]) \
and has the value of the XXXModule[metic]. This is generally used in some \
cycles such as Sum[XXXModule[metric]], which is slow and now is replaced by \
Sum[XXX].\
\>", "Text",
 CellChangeTimes->{{3.574660989498006*^9, 3.574661175272561*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Parameters & Functions", "Section",
 CellChangeTimes->{{3.569837498552577*^9, 3.569837500071067*^9}, {
  3.5698378769618*^9, 3.569837908550807*^9}}],

Cell[CellGroupData[{

Cell["\<\
Parameters that you have to input:\
\>", "Subsection",
 CellChangeTimes->{{3.569837967570937*^9, 3.5698379840463467`*^9}}],

Cell[TextData[{
 "The dimension of the space-time, denoted by ",
 StyleBox["\[OpenCurlyDoubleQuote]dim\[CloseCurlyDoubleQuote]",
  FontWeight->"Bold"],
 ";\nThe notions of coordinates of the space-time, denoted by ",
 StyleBox["\[OpenCurlyDoubleQuote]coordinates\[CloseCurlyDoubleQuote]",
  FontWeight->"Bold"],
 ";\n",
 StyleBox["the metric",
  FontWeight->"Bold"],
 ".\nThe notion of metric, denoted by ",
 StyleBox["\[OpenCurlyDoubleQuote]metricMatrix\[CloseCurlyDoubleQuote]",
  FontWeight->"Bold"],
 ".\nThe order for perturbation expansion, denoted by ",
 StyleBox["\[OpenCurlyDoubleQuote]ordier\[CloseCurlyDoubleQuote]",
  FontWeight->"Bold"],
 "."
}], "Text",
 CellChangeTimes->{{3.569837986468251*^9, 3.5698380648517857`*^9}, {
  3.5716517605383673`*^9, 3.5716518075440903`*^9}, {3.592284219266006*^9, 
  3.592284220451365*^9}, {3.592285105256781*^9, 3.592285134757207*^9}, {
  3.5948007387226057`*^9, 3.594800766902478*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Functions contained in the package \[OpenCurlyQuote]ModuleMatrix.m\
\[CloseCurlyQuote]:\
\>", "Subsection",
 CellChangeTimes->{{3.569837927462562*^9, 3.569837954058692*^9}, {
   3.592284228419404*^9, 3.592284230307067*^9}, 3.594800544936892*^9}],

Cell[TextData[{
 StyleBox["\[OpenCurlyQuote]gUpIndexMatrixModule[metricMatrix]\
\[CloseCurlyQuote] for ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   SuperscriptBox["g", "ab"], TraditionalForm]],
  FontWeight->"Bold"],
 StyleBox[", where g is the metric;\n\
\[OpenCurlyQuote]gammaDownIndexMatrixModule[metricMatrix]\[CloseCurlyQuote] \
for ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[CapitalGamma]", "abc"], TraditionalForm]],
  FontWeight->"Bold"],
 StyleBox[";\n\[OpenCurlyQuote]affineConnectionMatrixModule[metricMatrix]\
\[CloseCurlyQuote] for ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    SuperscriptBox["\[CapitalGamma]", "a"], "bc"], TraditionalForm]],
  FontWeight->"Bold"],
 StyleBox[", i.e., the affine connection;\n\
\[OpenCurlyQuote]rUpIndexMatrixModule[metricMatrix]\[CloseCurlyQuote] for ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    SuperscriptBox["R", "a"], "bcd"], TraditionalForm]],
  FontWeight->"Bold"],
 StyleBox[";\n\[OpenCurlyQuote]rDownIndexMatrixModule[metricMatrix]\
\[CloseCurlyQuote] for ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   SubscriptBox["R", "abcd"], TraditionalForm]],
  FontWeight->"Bold"],
 StyleBox[";\n\[OpenCurlyQuote]ricciTensorMatrixModule[metricMatrix]\
\[CloseCurlyQuote] for ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   SubscriptBox["R", "ab"], TraditionalForm]],
  FontWeight->"Bold"],
 StyleBox[", i.e., the Ricci tensor;\n\
\[OpenCurlyQuote]ricciScalarMatrixModule[metricMatrix]\[CloseCurlyQuote] for ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox["R", TraditionalForm]],
  FontWeight->"Bold"],
 StyleBox[", i.e., the Ricci scalar;\n\
\[OpenCurlyQuote]einsteinTensorMatrixModule[metricMatrix]\[CloseCurlyQuote] \
for ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   SubscriptBox["G", "ab"], TraditionalForm]],
  FontWeight->"Bold"],
 StyleBox[", i.e., the Einstein tensor;\n\
\[OpenCurlyQuote]einsteinTensorUpIndexMatrixModule[metricMatrix]\
\[CloseCurlyQuote] for ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   SuperscriptBox["G", "ab"], TraditionalForm]],
  FontWeight->"Bold"],
 StyleBox[".",
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->{{3.569837514072884*^9, 3.569837893523718*^9}, {
  3.592284240994499*^9, 3.592284277808857*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Examples", "Section",
 CellChangeTimes->{{3.56983095094844*^9, 3.569830953299737*^9}}],

Cell[CellGroupData[{

Cell["Basics", "Subsection",
 CellChangeTimes->{{3.594790346170883*^9, 3.594790358665821*^9}, 
   3.615198282988642*^9}],

Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.592284880311162*^9, 3.592284883112567*^9}}],

Cell[CellGroupData[{

Cell["Parameters inputted:", "Subsubsection",
 CellChangeTimes->{{3.615198285754018*^9, 3.615198291301934*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dim", " ", "=", " ", "4"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"The", " ", "dimension", " ", "of", " ", "space"}], "-", 
    RowBox[{"time", " ", "under", " ", 
     RowBox[{"consideration", "."}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"order", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"simplifyOrNot", "=", " ", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"coordinates", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Set", " ", "the", " ", "notions", " ", "of", " ", 
    RowBox[{"coordinates", "."}]}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"metricMatrix", " ", "=", " ", 
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], ",", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], ",", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"], ",", " ", 
       RowBox[{"-", "1"}]}], "}"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Input", " ", "the", " ", 
      RowBox[{"metric", ".", " ", "I"}], " ", "prefer", " ", 
      RowBox[{"letter", " ", "'"}], 
      RowBox[{
       RowBox[{"g", "'"}], ".", " ", "You"}], " ", "can", " ", "choice", " ", 
      "any", " ", "letter", " ", "you", " ", 
      RowBox[{"prefer", "!"}], " ", "Here", " ", "is", " ", "the", " ", 
      "Walker"}], "-", 
     RowBox[{
     "Robertson", " ", "metric", " ", "as", " ", "an", " ", "example"}]}], 
    ",", " ", 
    RowBox[{"with", " ", "t", " ", "denoting", " ", 
     RowBox[{"time", "."}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"metricMatrix", "//", "MatrixForm", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"You", " ", 
    RowBox[{"see", "."}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.569756510161916*^9, 3.569756691868828*^9}, {
  3.56975924017519*^9, 3.5697592416101313`*^9}, {3.5698370851443663`*^9, 
  3.56983718134858*^9}, {3.5698380809439907`*^9, 3.5698381864238853`*^9}, {
  3.571651506032627*^9, 3.571651532636674*^9}, {3.5716516556227016`*^9, 
  3.571651682640203*^9}, {3.5746614337433777`*^9, 3.574661433866157*^9}, {
  3.592284059718238*^9, 3.5922840729232903`*^9}, {3.592284783802566*^9, 
  3.59228484970203*^9}, {3.59332398262983*^9, 3.593323988912764*^9}, {
  3.594799572415524*^9, 3.594799588017425*^9}, {3.615198348681739*^9, 
  3.615198393913497*^9}, {3.616300165433002*^9, 3.616300169719404*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"], "0", "0", "0"},
     {"0", 
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"], "0", "0"},
     {"0", "0", 
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"], "0"},
     {"0", "0", "0", 
      RowBox[{"-", "1"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.569756649887281*^9, 3.569756694723145*^9}, 
   3.5697569657712593`*^9, 3.569757088954145*^9, {3.5697571359312468`*^9, 
   3.569757169882304*^9}, 3.569757239121399*^9, 3.5697584042082357`*^9, 
   3.569758525191443*^9, 3.56975872364003*^9, {3.5697587579519997`*^9, 
   3.569758764752822*^9}, 3.569758821616527*^9, 3.569758962681341*^9, 
   3.569759120859476*^9, 3.569759242207272*^9, 3.5697594685246887`*^9, 
   3.569759520227345*^9, 3.569759609720005*^9, 3.569759683758856*^9, 
   3.5697598589955807`*^9, 3.5697600233444023`*^9, 3.569760114269063*^9, 
   3.5697602265995827`*^9, 3.569760312547658*^9, 3.569760861566956*^9, 
   3.56979612318647*^9, 3.5698315556493597`*^9, 3.569833901411895*^9, 
   3.569834330133922*^9, 3.569834597999909*^9, 3.569834942117347*^9, {
   3.5698357127815933`*^9, 3.569835741703595*^9}, 3.5698394219671717`*^9, 
   3.569839614215654*^9, 3.5700965550082483`*^9, 3.571651495392617*^9, 
   3.57165153834494*^9, 3.571651599756185*^9, 3.57466143757596*^9, 
   3.5747429486170483`*^9, 3.59228407473888*^9, 3.592284718068508*^9, {
   3.592284787782444*^9, 3.592284795301971*^9}, 3.592284850181024*^9, 
   3.592284885574108*^9, 3.593171103862625*^9, 3.593231881258214*^9, 
   3.593323992780284*^9, 3.5940264082061453`*^9, 3.5940270538118763`*^9, 
   3.5945520638350153`*^9, 3.594555230574576*^9, 3.594701404396558*^9, 
   3.594784838606455*^9, 3.594800778206977*^9, 3.594800875161765*^9, 
   3.594801030726824*^9, 3.594803080162108*^9, 3.594817339085941*^9, 
   3.594860553587118*^9, 3.594860655130567*^9, 3.5948650265781918`*^9, 
   3.5948652124124537`*^9, 3.5948673060744*^9, 3.594868950433402*^9, 
   3.615198362284521*^9, 3.615198395201573*^9, {3.616300161035614*^9, 
   3.616300170800453*^9}, 3.616322730659806*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"<<", "TensorCalculator`ModuleMatrix`"}]], "Input",
 CellChangeTimes->{{3.569833905261018*^9, 3.569833957271414*^9}, 
   3.569834120962534*^9, {3.5698343121382847`*^9, 3.5698343618314867`*^9}, {
   3.5698344928422832`*^9, 3.5698345181185617`*^9}, {3.569834585095459*^9, 
   3.569834592061051*^9}, {3.5698346917291727`*^9, 3.569834695392579*^9}, {
   3.56983476223453*^9, 3.569834774228941*^9}, {3.569834944233984*^9, 
   3.569834961393615*^9}, {3.569835019172186*^9, 3.569835045370973*^9}, 
   3.56983516398995*^9, {3.569835274286542*^9, 3.5698352751767607`*^9}, {
   3.569835330442205*^9, 3.569835331115631*^9}, {3.569835695510777*^9, 
   3.569835725297717*^9}, {3.5698371860140057`*^9, 3.56983720493393*^9}, {
   3.592284117700417*^9, 3.592284138011631*^9}, 3.592284568829933*^9, 
   3.592284678284606*^9, {3.5922848744834967`*^9, 3.592284875271179*^9}, {
   3.593162062922305*^9, 3.593162135159004*^9}, {3.593170585327511*^9, 
   3.593170610641437*^9}, {3.5931706961683073`*^9, 3.593170703918516*^9}, {
   3.59317074098145*^9, 3.593170762414263*^9}, {3.616300196601333*^9, 
   3.616300225104376*^9}, {3.616300277279503*^9, 3.616300284912494*^9}, {
   3.616322741232869*^9, 3.616322753351476*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"einsteinTensorMatrixModule", "[", "metricMatrix", "]"}], "//", 
   "MatrixForm"}], "//", "Timing"}]], "Input",
 CellChangeTimes->{{3.569834338530699*^9, 3.569834389436818*^9}, {
   3.5698357492866917`*^9, 3.569835760033688*^9}, 3.569837211232975*^9, {
   3.569839433799223*^9, 3.569839435869809*^9}, {3.592284142343298*^9, 
   3.592284143227869*^9}, {3.5922848913866997`*^9, 3.592284894114656*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.3989389999999999`", ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["a", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "2"]}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"a", "[", "t", "]"}], " ", 
          RowBox[{
           SuperscriptBox["a", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}]}], "0", "0", "0"},
       {"0", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["a", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "2"]}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"a", "[", "t", "]"}], " ", 
          RowBox[{
           SuperscriptBox["a", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}]}], "0", "0"},
       {"0", "0", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["a", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "2"]}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"a", "[", "t", "]"}], " ", 
          RowBox[{
           SuperscriptBox["a", "\[Prime]\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}]}], "0"},
       {"0", "0", "0", 
        FractionBox[
         RowBox[{"3", " ", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["a", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "2"]}], 
         SuperscriptBox[
          RowBox[{"a", "[", "t", "]"}], "2"]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "}"}]], "Output",
 CellChangeTimes->{{3.569834346941099*^9, 3.569834390501904*^9}, 
   3.569834595895873*^9, 3.569834699185214*^9, 3.569834932459942*^9, {
   3.569835702350559*^9, 3.569835760877224*^9}, {3.5698394261837463`*^9, 
   3.569839437182912*^9}, 3.569839620648993*^9, 3.570096555208033*^9, 
   3.57165149906742*^9, 3.571651540942401*^9, 3.57165161022143*^9, 
   3.57466144493283*^9, 3.5747429515243063`*^9, 3.592284144258402*^9, 
   3.5922847274270973`*^9, 3.592284797775621*^9, {3.5922848878929*^9, 
   3.592284894647625*^9}, 3.593171106047426*^9, 3.593171137122445*^9, 
   3.59323188356194*^9, 3.593323998048136*^9, 3.594026439393463*^9, 
   3.594027056861291*^9, 3.594555233848466*^9, 3.594701407189562*^9, 
   3.5947848425359497`*^9, 3.594800780455867*^9, 3.5948008770430613`*^9, 
   3.594817342887271*^9, 3.594860556088606*^9, 3.594860657135261*^9, 
   3.594864788365528*^9, 3.594865036135501*^9, 3.594865213842991*^9, 
   3.594867307923195*^9, 3.5948689536809893`*^9, 3.615198366939732*^9, 
   3.615198400829772*^9, 3.61630032396828*^9, 3.616322756426313*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"einsteinTensorUpIndexMatrixModule", "[", "metricMatrix", "]"}], "//",
    "MatrixForm"}], "//", "Timing"}]], "Input",
 CellChangeTimes->{{3.592285008137748*^9, 3.5922850096336393`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.2189670000000001`", ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{
             SuperscriptBox["a", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}], "2"], "+", 
           RowBox[{"2", " ", 
            RowBox[{"a", "[", "t", "]"}], " ", 
            RowBox[{
             SuperscriptBox["a", "\[Prime]\[Prime]",
              MultilineFunction->None], "[", "t", "]"}]}]}], 
          SuperscriptBox[
           RowBox[{"a", "[", "t", "]"}], "4"]]}], "0", "0", "0"},
       {"0", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{
             SuperscriptBox["a", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}], "2"], "+", 
           RowBox[{"2", " ", 
            RowBox[{"a", "[", "t", "]"}], " ", 
            RowBox[{
             SuperscriptBox["a", "\[Prime]\[Prime]",
              MultilineFunction->None], "[", "t", "]"}]}]}], 
          SuperscriptBox[
           RowBox[{"a", "[", "t", "]"}], "4"]]}], "0", "0"},
       {"0", "0", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{
             SuperscriptBox["a", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}], "2"], "+", 
           RowBox[{"2", " ", 
            RowBox[{"a", "[", "t", "]"}], " ", 
            RowBox[{
             SuperscriptBox["a", "\[Prime]\[Prime]",
              MultilineFunction->None], "[", "t", "]"}]}]}], 
          SuperscriptBox[
           RowBox[{"a", "[", "t", "]"}], "4"]]}], "0"},
       {"0", "0", "0", 
        FractionBox[
         RowBox[{"3", " ", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["a", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "2"]}], 
         SuperscriptBox[
          RowBox[{"a", "[", "t", "]"}], "2"]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "}"}]], "Output",
 CellChangeTimes->{3.592285010463009*^9, 3.593171107641796*^9, 
  3.593171138470628*^9, 3.593231884853331*^9, 3.593324000314588*^9, 
  3.59402644160292*^9, 3.59402705788433*^9, 3.594555235485388*^9, 
  3.5947014091293573`*^9, 3.594784843429172*^9, 3.594800781500907*^9, 
  3.5948008778322573`*^9, 3.59480104017435*^9, 3.594803087219775*^9, 
  3.594817344102436*^9, 3.5948605571262217`*^9, 3.594860658195387*^9, 
  3.59486478924259*^9, 3.594865036895989*^9, 3.594865214963769*^9, 
  3.594867309354124*^9, 3.594868954826992*^9, 3.615198405065528*^9, 
  3.616300326057787*^9, 3.616322758936577*^9}]
}, Open  ]],

Cell["\<\
After running this module, a variable is named einsteinTensor, in this \
example, generated:\
\>", "Text",
 CellChangeTimes->{{3.574742890819235*^9, 3.574742927531149*^9}, {
  3.594817344905819*^9, 3.594817346467833*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"einsteinTensorMatrix", ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.5747429294099627`*^9, 3.574742943402691*^9}, {
  3.592284152886648*^9, 3.592284153739419*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["a", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "2"]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"a", "[", "t", "]"}], " ", 
        RowBox[{
         SuperscriptBox["a", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}], "0", "0", "0"},
     {"0", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["a", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "2"]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"a", "[", "t", "]"}], " ", 
        RowBox[{
         SuperscriptBox["a", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}], "0", "0"},
     {"0", "0", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["a", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "2"]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"a", "[", "t", "]"}], " ", 
        RowBox[{
         SuperscriptBox["a", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}], "0"},
     {"0", "0", "0", 
      FractionBox[
       RowBox[{"3", " ", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["a", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "2"]}], 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.57474295459247*^9, 3.5922841543314133`*^9, 3.592284728984479*^9, 
   3.5922847989050417`*^9, 3.592284896808901*^9, {3.593171109643559*^9, 
   3.593171139637148*^9}, 3.59323188757038*^9, 3.593324006487366*^9, 
   3.59402644330422*^9, 3.5940270604799557`*^9, 3.594701412916429*^9, 
   3.59478484489491*^9, 3.594800879289681*^9, {3.594801036864503*^9, 
   3.594801041176177*^9}, {3.5948030841794167`*^9, 3.594803088564291*^9}, 
   3.594817348553129*^9, 3.594860558511507*^9, 3.594860659271717*^9, 
   3.5948647903386374`*^9, 3.5948650384236727`*^9, 3.5948652163665237`*^9, 
   3.594867310214843*^9, 3.594868956169527*^9, 3.615198414352628*^9, 
   3.616300329008947*^9, 3.61632276327076*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"<<", "TensorCalculator`ModuleAbstractedIndeces`"}]], "Input",
 CellChangeTimes->{3.594028416744553*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"metric", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "lo"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "lo"}], "}"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.592284184462731*^9, 3.592284201007072*^9}, {
  3.5922848042616034`*^9, 3.592284804316042*^9}, {3.594026466532111*^9, 
  3.59402649906208*^9}}],

Cell[BoxData[
 SuperscriptBox[
  RowBox[{"a", "[", "t", "]"}], "2"]], "Output",
 CellChangeTimes->{
  3.592284201622666*^9, {3.5922847305398903`*^9, 3.592284768206655*^9}, {
   3.592284800948998*^9, 3.592284804717758*^9}, 3.592284899286397*^9, 
   3.592285021486669*^9, 3.593171141637197*^9, 3.5932318899499607`*^9, 
   3.593324010496446*^9, {3.594026476418819*^9, 3.59402649943228*^9}, 
   3.5940270618659067`*^9, 3.5947848477600718`*^9, 3.594800882118608*^9, {
   3.5948010428193417`*^9, 3.5948010499423227`*^9}, {3.594803090576055*^9, 
   3.594803099362321*^9}, 3.594817358731571*^9, 3.594817583490428*^9, 
   3.594817992223014*^9, 3.5948605713100777`*^9, 3.5948606613185053`*^9, 
   3.594865218849461*^9, 3.5948673121159887`*^9, 3.594868958239038*^9, 
   3.615198419693239*^9, 3.616322770104603*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"einsteinTensor", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"4", ",", "lo"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"4", ",", "lo"}], "}"}]}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"einsteinTensor", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"4", ",", "up"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"4", ",", "up"}], "}"}]}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{
  3.592284865851851*^9, {3.592284902096971*^9, 3.59228492392201*^9}, {
   3.5922849734517183`*^9, 3.592284981014105*^9}, {3.594026518534552*^9, 
   3.594026519709128*^9}, {3.594026711734416*^9, 3.594026722711925*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"3", " ", 
   SuperscriptBox[
    RowBox[{
     SuperscriptBox["a", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "2"]}], 
  SuperscriptBox[
   RowBox[{"a", "[", "t", "]"}], "2"]]], "Output",
 CellChangeTimes->{
  3.592284924437078*^9, 3.5922849820285587`*^9, {3.59228501875572*^9, 
   3.59228502204626*^9}, 3.593171142460867*^9, 3.593231890957575*^9, 
   3.59332401168327*^9, 3.5940267234846478`*^9, 3.5940270626190968`*^9, 
   3.5940281237864237`*^9, 3.5940286729373493`*^9, 3.594032119744658*^9, 
   3.5947848486250477`*^9, 3.5948008828368587`*^9, 3.594801050909452*^9, 
   3.594803100045231*^9, 3.594817471266866*^9, 3.594817584562719*^9, 
   3.594817993217037*^9, 3.594860572216815*^9, 3.59486066197435*^9, 
   3.594865219516116*^9, 3.594867312837986*^9, 3.5948689590660686`*^9, 
   3.615198420852736*^9, 3.616322771658631*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"3", " ", 
   SuperscriptBox[
    RowBox[{
     SuperscriptBox["a", "\[Prime]",
      MultilineFunction->None], "[", "t", "]"}], "2"]}], 
  SuperscriptBox[
   RowBox[{"a", "[", "t", "]"}], "2"]]], "Output",
 CellChangeTimes->{
  3.592284924437078*^9, 3.5922849820285587`*^9, {3.59228501875572*^9, 
   3.59228502204626*^9}, 3.593171142460867*^9, 3.593231890957575*^9, 
   3.59332401168327*^9, 3.5940267234846478`*^9, 3.5940270626190968`*^9, 
   3.5940281237864237`*^9, 3.5940286729373493`*^9, 3.594032119744658*^9, 
   3.5947848486250477`*^9, 3.5948008828368587`*^9, 3.594801050909452*^9, 
   3.594803100045231*^9, 3.594817471266866*^9, 3.594817584562719*^9, 
   3.594817993217037*^9, 3.594860572216815*^9, 3.59486066197435*^9, 
   3.594865219516116*^9, 3.594867312837986*^9, 3.5948689590660686`*^9, 
   3.615198420852736*^9, 3.616322771961133*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Contraction:", "Subsection",
 CellChangeTimes->{{3.594790387241702*^9, 3.594790389586143*^9}}],

Cell["\<\
Fetch the head and the indices of a given \[OpenCurlyDoubleQuote]standard\
\[CloseCurlyDoubleQuote] tensor \[OpenCurlyQuote]tensorA[{{k1,lo}, {k2,lo}}]\
\[CloseCurlyQuote], outputting as a list:\
\>", "Text",
 CellChangeTimes->{{3.616324979994754*^9, 3.616325044623268*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fetchHeadAndIndices", "[", 
  RowBox[{"tensorA", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"k1", ",", "lo"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"k2", ",", "lo"}], "}"}]}], "}"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.616324118002568*^9, 3.616324128143675*^9}, 
   3.6163243905538*^9, {3.616324506922292*^9, 3.616324517797604*^9}, {
   3.616324579942606*^9, 3.616324582937593*^9}, {3.616324962039256*^9, 
   3.616324969754236*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"tensorA", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"k1", ",", "lo"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k2", ",", "lo"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.616324128971316*^9, {3.61632438864682*^9, 3.6163243914931*^9}, {
   3.616324501924387*^9, 3.616324518229821*^9}, 3.616324583751438*^9, 
   3.616324970822593*^9}]
}, Open  ]],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["g", 
     RowBox[{"1", "\[Mu]"}]], " ", 
    SuperscriptBox["g", "\[Mu]1"]}], TraditionalForm]]],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["g", 
     RowBox[{"1", "\[Mu]"}]], " ", 
    SuperscriptBox["g", "\[Mu]2"]}], TraditionalForm]]],
 ":"
}], "Text",
 CellChangeTimes->{{3.594790431778254*^9, 3.594790489082501*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"contract", "[", 
  RowBox[{
   RowBox[{"metric", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "lo"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"k1", ",", "lo"}], "}"}]}], "}"}], "]"}], ",", " ", 
   RowBox[{"metric", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k1", ",", "up"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "up"}], "}"}]}], "}"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.616324837069574*^9, 3.61632485473499*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.616324855905135*^9}]
}, Open  ]],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["g", "\[Mu]\[Nu]"], " ", 
    SuperscriptBox["g", "\[Mu]\[Nu]"]}], TraditionalForm]]],
 ":"
}], "Text",
 CellChangeTimes->{{3.5947904752930803`*^9, 3.594790485850724*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"contract", "[", 
  RowBox[{
   RowBox[{"metric", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k1", ",", "lo"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"k2", ",", "lo"}], "}"}]}], "}"}], "]"}], ",", " ", 
   RowBox[{"metric", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k1", ",", "up"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k2", ",", "up"}], "}"}]}], "}"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.594790496884688*^9, 3.59479049804473*^9}, {
  3.616323643994893*^9, 3.616323653334212*^9}}],

Cell[BoxData["4"], "Output",
 CellChangeTimes->{
  3.5947904987760143`*^9, 3.5948009087876587`*^9, 3.5948031033985233`*^9, 
   3.594812581535524*^9, 3.594817590139758*^9, 3.594817997290343*^9, 
   3.594860575183119*^9, 3.594860664613735*^9, 3.594865222221652*^9, 
   3.594867316300084*^9, 3.59486896247128*^9, 3.61519842994719*^9, {
   3.616323639353325*^9, 3.616323659240943*^9}, 3.616323775434983*^9, 
   3.616323815496314*^9, {3.616323867371767*^9, 3.616323912023725*^9}, 
   3.616324740196329*^9, {3.616324799956454*^9, 3.616324826562894*^9}, 
   3.616324860357852*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Composition of \[OpenCurlyQuote]contract[]\[CloseCurlyQuote]:", \
"Subsubsection",
 CellChangeTimes->{{3.616325066386301*^9, 3.616325085927398*^9}}],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["R", "\[Alpha]\[Beta]"], " ", "=", " ", 
    RowBox[{
     SuperscriptBox["g", "\[Alpha]\[Mu]"], " ", 
     SuperscriptBox["g", "\[Beta]\[Nu]"], " ", 
     SubscriptBox["R", "\[Mu]\[Nu]"]}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ":"
}], "Text",
 CellChangeTimes->{{3.616325100311885*^9, 3.616325143074097*^9}}],

Cell[BoxData[
 RowBox[{"contract", "[", 
  RowBox[{
   RowBox[{"metric", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Alpha]1", ",", "up"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Mu]1", ",", "up"}], "}"}]}], "}"}], "]"}], ",", "%%%"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.616325146661036*^9, 3.616325174509147*^9}, 
   3.616325218726128*^9, {3.616325267708023*^9, 3.616325268066475*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Co-variant derivative:", "Subsection",
 CellChangeTimes->{{3.594790373442196*^9, 3.594790380970436*^9}}],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    SuperscriptBox["G", "00"], 
    RowBox[{";", "0"}]], TraditionalForm]]],
 ":"
}], "Text",
 CellChangeTimes->{{3.592284942998349*^9, 3.5922849650632772`*^9}, {
  3.594028124918013*^9, 3.5940281271103363`*^9}, {3.594801226161648*^9, 
  3.594801240820075*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CoD", "[", 
  RowBox[{"einsteinTensor", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4", ",", "up"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "up"}], "}"}]}], "}"}], ",", "4"}], "]"}]], "Input",
 CellChangeTimes->{{3.594026731932523*^9, 3.594026735877378*^9}, {
  3.594027416568549*^9, 3.5940274223038*^9}, {3.594028131867712*^9, 
  3.594028145690843*^9}, {3.5940282493317738`*^9, 3.594028257161173*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"6", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["a", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "3"]}], "+", 
     RowBox[{
      RowBox[{"a", "[", "t", "]"}], " ", 
      RowBox[{
       SuperscriptBox["a", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], " ", 
      RowBox[{
       SuperscriptBox["a", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], 
  SuperscriptBox[
   RowBox[{"a", "[", "t", "]"}], "3"]]], "Output",
 CellChangeTimes->{
  3.592285055108797*^9, 3.5931711445414343`*^9, 3.593231892626553*^9, 
   3.593324050055945*^9, {3.594026737966393*^9, 3.594026757300734*^9}, 
   3.594027028061247*^9, 3.594027064146194*^9, 3.594027150417982*^9, {
   3.594027230144994*^9, 3.59402724196948*^9}, {3.594027397327952*^9, 
   3.594027422783595*^9}, 3.59402752455862*^9, 3.594027785310479*^9, 
   3.594027832122671*^9, {3.594028117043004*^9, 3.594028146099021*^9}, {
   3.594028228383115*^9, 3.594028257921198*^9}, 3.594028674711006*^9, 
   3.594031165387609*^9, 3.594031253933967*^9, 3.594031773449664*^9, {
   3.594032115475224*^9, 3.594032121050161*^9}, 3.594800884566966*^9, 
   3.5948010524113693`*^9, 3.594801082887623*^9, {3.594802032875332*^9, 
   3.594802046459178*^9}, 3.594802635274763*^9, 3.594803107532856*^9, 
   3.5948116126404457`*^9, 3.594812035669636*^9, 3.594812098043103*^9, 
   3.594817592820092*^9, 3.594817999538331*^9, 3.594860577199699*^9, 
   3.5948606661364307`*^9, {3.594864642423757*^9, 3.5948646585360613`*^9}, 
   3.5948652271125526`*^9, 3.5948672709196157`*^9, 3.594867317449917*^9, 
   3.5948675253973103`*^9, 3.594867712225492*^9, 3.594867804748279*^9, 
   3.5948679268304462`*^9, 3.594868963807774*^9, 3.615198433855716*^9, 
   3.616324863308126*^9}]
}, Open  ]],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    SuperscriptBox["G", "01"], 
    RowBox[{";", "1"}]], TraditionalForm]]],
 ":"
}], "Text",
 CellChangeTimes->{{3.594801247382236*^9, 3.594801256303155*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CoD", "[", 
  RowBox[{"einsteinTensor", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4", ",", "up"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "up"}], "}"}]}], "}"}], ",", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.59403110801412*^9, 3.594031110587846*^9}, {
  3.594801070740926*^9, 3.594801074082561*^9}, {3.594801738711316*^9, 
  3.594801749125827*^9}, {3.594801806742697*^9, 3.59480182178506*^9}, {
  3.594802135460229*^9, 3.594802137895475*^9}, {3.5948026612576714`*^9, 
  3.5948026644561653`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", 
   RowBox[{
    SuperscriptBox["a", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      RowBox[{
       SuperscriptBox["a", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], "2"], "-", 
     RowBox[{
      RowBox[{"a", "[", "t", "]"}], " ", 
      RowBox[{
       SuperscriptBox["a", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], 
  SuperscriptBox[
   RowBox[{"a", "[", "t", "]"}], "3"]]], "Output",
 CellChangeTimes->{
  3.5940311110846786`*^9, {3.594031161369512*^9, 3.5940311663802547`*^9}, {
   3.594031252609173*^9, 3.594031254866899*^9}, {3.594031772214856*^9, 
   3.594031774911483*^9}, 3.594031932447027*^9, {3.594032116412531*^9, 
   3.594032121854176*^9}, 3.59480088583549*^9, {3.594801053523603*^9, 
   3.594801083542953*^9}, {3.5948017449093447`*^9, 3.59480174943769*^9}, {
   3.59480181235682*^9, 3.5948018230454483`*^9}, {3.594802030635594*^9, 
   3.594802048331162*^9}, 3.594802139947097*^9, {3.594802634160658*^9, 
   3.594802664903261*^9}, 3.5948030567249527`*^9, {3.594803104883498*^9, 
   3.594803106285062*^9}, {3.5948116109073477`*^9, 3.5948116147258587`*^9}, 
   3.594812037483088*^9, 3.59481209937656*^9, 3.59481759525128*^9, 
   3.594818001666606*^9, 3.594860667495544*^9, 3.594864659773121*^9, 
   3.5948652282931337`*^9, 3.594867272430677*^9, 3.5948673188102493`*^9, 
   3.594867526955925*^9, 3.5948677130811357`*^9, 3.59486780550871*^9, 
   3.5948679278899508`*^9, 3.594868965347384*^9, 3.615198446605082*^9, 
   3.616324870156519*^9}]
}, Open  ]],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    SuperscriptBox["G", 
     RowBox[{"0", " ", "\[Nu]"}]], 
    RowBox[{";", "\[Nu]"}]], TraditionalForm]]],
 ":"
}], "Text",
 CellChangeTimes->{{3.594801274429986*^9, 3.594801290629877*^9}, {
  3.594801357655065*^9, 3.5948013858553867`*^9}, {3.594801787004163*^9, 
  3.5948017885162153`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{"CoD", "[", 
     RowBox[{"einsteinTensor", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"4", ",", "up"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i1", ",", "up"}], "}"}]}], "}"}], ",", "i1"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i1", ",", "1", ",", "dim"}], "}"}]}], "]"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{
  3.592285084783787*^9, {3.5940267745042048`*^9, 3.5940267818944607`*^9}, {
   3.5940268227825623`*^9, 3.5940268383513527`*^9}, {3.5940281710484457`*^9, 
   3.594028179605688*^9}, {3.594028240114645*^9, 3.594028265784754*^9}, {
   3.594801077357314*^9, 3.594801079839357*^9}, {3.594801320180551*^9, 
   3.59480133621966*^9}, {3.5948673914104433`*^9, 3.594867396888618*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.592285062891863*^9, 3.592285086181374*^9}, 
   3.593171145492927*^9, 3.5932318937891607`*^9, 3.593324051369498*^9, 
   3.594026787101386*^9, 3.5940268390249987`*^9, 3.594027029370332*^9, 
   3.5940270654421997`*^9, 3.5940271513300667`*^9, {3.594027231049541*^9, 
   3.594027243150226*^9}, {3.5940273983200912`*^9, 3.594027424424095*^9}, 
   3.59402752599864*^9, 3.594027786404694*^9, 3.5940278328690643`*^9, 
   3.5940281187144547`*^9, 3.5940281501629333`*^9, 3.5940281813948812`*^9, {
   3.594028229193551*^9, 3.5940282663455667`*^9}, 3.594028675406417*^9, 
   3.5940319356139793`*^9, {3.594032117588703*^9, 3.594032122960002*^9}, 
   3.594800886867825*^9, {3.594801080418209*^9, 3.594801084339189*^9}, 
   3.594801389145694*^9, 3.59480182974909*^9, 3.594802050203321*^9, 
   3.594802636990527*^9, 3.59480310882552*^9, 3.594812039932137*^9, 
   3.594812100881669*^9, 3.594817598093129*^9, 3.594818003523498*^9, 
   3.594860668756564*^9, 3.5948646607466373`*^9, 3.594865229573197*^9, 
   3.594867273753332*^9, 3.594867319859336*^9, 3.59486739816549*^9, 
   3.594867529181983*^9, 3.5948677143225803`*^9, 3.594867806549897*^9, 
   3.594867929604623*^9, 3.594868967344589*^9, 3.615198449104665*^9, 
   3.616324874764657*^9}]
}, Open  ]],

Cell[TextData[{
 "Or, calculate the ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["G", 
     RowBox[{
      RowBox[{"0", " ", "\[Mu]"}], " ", ";", " ", "\[Vee]"}]], " ", 
    SuperscriptBox["g", 
     RowBox[{"\[Mu]", " ", "\[Vee]"}]]}], TraditionalForm]]],
 ":"
}], "Text",
 CellChangeTimes->{{3.594801274429986*^9, 3.594801290629877*^9}, {
  3.594801357655065*^9, 3.5948013858553867`*^9}, {3.594801787004163*^9, 
  3.5948017885162153`*^9}, {3.594812173121255*^9, 3.594812211066053*^9}, {
  3.594869175635079*^9, 3.5948691887337103`*^9}}],

Cell[TextData[{
 "Such as ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["G", 
    RowBox[{"01", " ", ";", " ", "1"}]], TraditionalForm]]],
 ":"
}], "Text",
 CellChangeTimes->{{3.594869037195682*^9, 3.594869077460548*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CoD", "[", 
  RowBox[{"einsteinTensor", ",", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4", ",", "lo"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "lo"}], "}"}]}], "}"}], ",", " ", "1"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.59486364521945*^9, 3.594863650553693*^9}, {
  3.5948639327681913`*^9, 3.594863943367765*^9}, {3.594867436621773*^9, 
  3.5948674494520273`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{
       SuperscriptBox["a", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], "3"]}], 
    RowBox[{"a", "[", "t", "]"}]]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{
    SuperscriptBox["a", "\[Prime]",
     MultilineFunction->None], "[", "t", "]"}], " ", 
   RowBox[{
    SuperscriptBox["a", "\[Prime]\[Prime]",
     MultilineFunction->None], "[", "t", "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.5948636510010977`*^9, {3.594863937335886*^9, 3.594863943926586*^9}, 
   3.59486400921735*^9, {3.594864333652238*^9, 3.5948643358518667`*^9}, 
   3.5948646623018227`*^9, 3.594865231514598*^9, {3.594865548915654*^9, 
   3.59486556108594*^9}, 3.594867275542688*^9, 3.594867321525525*^9, {
   3.594867450126113*^9, 3.594867463613454*^9}, 3.5948675315646343`*^9, 
   3.594867716242825*^9, 3.5948678080919437`*^9, 3.5948679310949183`*^9, 
   3.594868969370576*^9, 3.5948694323201323`*^9, 3.615198451911138*^9, 
   3.616324877624488*^9}]
}, Open  ]],

Cell[TextData[{
 "Use the \[OpenCurlyDoubleQuote]contract[]\[CloseCurlyDoubleQuote] to \
calculate ",
 "the ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["G", 
     RowBox[{
      RowBox[{"0", " ", "\[Mu]"}], " ", ";", " ", "\[Vee]"}]], " ", 
    SuperscriptBox["g", 
     RowBox[{"\[Mu]", " ", "\[Vee]"}]]}], TraditionalForm]]],
 ":"
}], "Text",
 CellChangeTimes->{{3.5948691678666267`*^9, 3.594869169994372*^9}, {
  3.594869200658424*^9, 3.594869213310026*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Define", " ", "the", " ", 
    RowBox[{
     FormBox[
      SubscriptBox["G", 
       RowBox[{
        RowBox[{"0", "\[Mu]"}], ";", "\[Vee]"}]],
      TraditionalForm], ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i1_", ",", "lo"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i2_", ",", "lo"}], "}"}]}], "}"}], "]"}], " ", ":=", " ", 
     RowBox[{"CoD", "[", 
      RowBox[{"einsteinTensor", ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"4", ",", "lo"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i1", ",", "lo"}], "}"}]}], "}"}], ",", " ", "i2"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Then", " ", "use", " ", "\"\<contract[]\>\""}], ":"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"contract", "[", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"k1", ",", "lo"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"k2", ",", "lo"}], "}"}]}], "}"}], "]"}], ",", " ", 
      RowBox[{"metric", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"k1", ",", "up"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"k2", ",", "up"}], "}"}]}], "}"}], "]"}]}], "]"}], "//", 
    "Simplify"}]}]}]], "Input",
 CellChangeTimes->{{3.594818128206233*^9, 3.594818138230102*^9}, {
  3.594869014720305*^9, 3.594869016935047*^9}, {3.59486934223759*^9, 
  3.594869426672316*^9}, {3.616324887588064*^9, 3.616324897722521*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.594817709957424*^9, 3.594818006568109*^9, {3.594818071596972*^9, 
   3.594818087491027*^9}, 3.594818138869379*^9, 3.594860670800046*^9, 
   3.594864669185625*^9, 3.594867332769487*^9, 3.594867534070067*^9, 
   3.594867718250495*^9, 3.594867809921998*^9, 3.594867933002759*^9, 
   3.594868974666793*^9, {3.594869430430648*^9, 3.594869433342505*^9}, 
   3.615198454041322*^9, 3.616324898651645*^9}]
}, Open  ]],

Cell["\<\
Or, equivalently, use the \
\[OpenCurlyDoubleQuote]Sum[]\[CloseCurlyDoubleQuote] directly:\
\>", "Text",
 CellChangeTimes->{{3.594869103586911*^9, 3.594869111450293*^9}, {
  3.594869220866438*^9, 3.59486923607257*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"CoD", "[", 
      RowBox[{"einsteinTensor", ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"4", ",", "lo"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k1", ",", "lo"}], "}"}]}], "}"}], ",", " ", "k2"}], "]"}], 
     "*", 
     RowBox[{"metric", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"k1", ",", "up"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k2", ",", "up"}], "}"}]}], "}"}], "]"}]}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"k1", ",", "1", ",", "dim"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"k2", ",", "1", ",", "dim"}], "}"}]}], "]"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.59481762307489*^9, 3.594817682447724*^9}, {
  3.594817717379377*^9, 3.594817719488434*^9}, {3.594818034072378*^9, 
  3.594818062985706*^9}, {3.594818106331179*^9, 3.594818121725368*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.594817683265952*^9, 3.594817720506785*^9}, {
   3.594818009755291*^9, 3.594818122340292*^9}, 3.5948606727963123`*^9, 
   3.594864670577608*^9, 3.59486733347978*^9, 3.594867719086094*^9, 
   3.594867812466879*^9, 3.594867933953498*^9, 3.59486943621164*^9, 
   3.615198456272179*^9, 3.616324916150272*^9}]
}, Open  ]],

Cell[TextData[{
 "In summary, we get:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     SuperscriptBox["G", 
      RowBox[{"0", " ", "\[Nu]"}]], 
     RowBox[{";", "\[Nu]"}]], " ", "=", " ", "0"}], TraditionalForm]]],
 "."
}], "Text",
 CellChangeTimes->{{3.592285094157527*^9, 3.592285095303619*^9}, {
  3.5948012048033*^9, 3.594801221620729*^9}, {3.594801792788332*^9, 
  3.594801793983708*^9}, {3.5948691318749104`*^9, 3.5948691358754053`*^9}}],

Cell["\<\
* Note: As you see, here, the function \[OpenCurlyDoubleQuote]contract[]\
\[CloseCurlyDoubleQuote] is too weak to exist. While, this function becomes \
really powerful when the number of the indeces contracted becomes quite large!\
\>", "Text",
 CellChangeTimes->{{3.594867969300222*^9, 3.594868067422845*^9}, {
  3.594869253739683*^9, 3.594869254019158*^9}}],

Cell["\<\
For scalar, such as Ricci scalar (\[OpenCurlyDoubleQuote]ricci[]\
\[CloseCurlyDoubleQuote] with variable \[OpenCurlyDoubleQuote]NoIndex\
\[CloseCurlyDoubleQuote] is just the Ricci scalar, which has no index.):\
\>", "Text",
 CellChangeTimes->{{3.594864870578183*^9, 3.594864882577455*^9}, {
  3.5948692808503447`*^9, 3.594869326233482*^9}}],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubscriptBox["R", 
    RowBox[{" ", 
     RowBox[{";", " ", "0"}]}]], TraditionalForm]]],
 ":"
}], "Text",
 CellChangeTimes->{{3.594869458896182*^9, 3.59486951080912*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CoD", "[", 
  RowBox[{"ricci", ",", " ", "NoIndex", ",", " ", "4"}], "]"}]], "Input",
 CellChangeTimes->{{3.594864721466333*^9, 3.594864746480692*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"6", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["a", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "3"]}], "+", 
     RowBox[{
      RowBox[{"a", "[", "t", "]"}], " ", 
      RowBox[{
       SuperscriptBox["a", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], " ", 
      RowBox[{
       SuperscriptBox["a", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"], " ", 
      RowBox[{
       SuperscriptBox["a", 
        TagBox[
         RowBox[{"(", "3", ")"}],
         Derivative],
        MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], 
  SuperscriptBox[
   RowBox[{"a", "[", "t", "]"}], "3"]]], "Output",
 CellChangeTimes->{{3.5948647318733187`*^9, 3.594864747432939*^9}, 
   3.59486484214249*^9, 3.594867335441105*^9, 3.594869440315421*^9, 
   3.615198460027219*^9}]
}, Open  ]],

Cell[TextData[{
 ", which is just the ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["R", 
    RowBox[{" ", 
     RowBox[{",", " ", "0"}]}]], TraditionalForm]]],
 ":"
}], "Text",
 CellChangeTimes->{{3.594869514810668*^9, 3.594869550641274*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"ricci", "[", "NoIndex", "]"}], ",", " ", 
    RowBox[{"coordinates", "[", 
     RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.594864733974271*^9, 3.5948647704652653`*^9}, {
  3.594864846177814*^9, 3.594864847871413*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"6", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["a", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "3"]}], "+", 
     RowBox[{
      RowBox[{"a", "[", "t", "]"}], " ", 
      RowBox[{
       SuperscriptBox["a", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], " ", 
      RowBox[{
       SuperscriptBox["a", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"], " ", 
      RowBox[{
       SuperscriptBox["a", 
        TagBox[
         RowBox[{"(", "3", ")"}],
         Derivative],
        MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], 
  SuperscriptBox[
   RowBox[{"a", "[", "t", "]"}], "3"]]], "Output",
 CellChangeTimes->{
  3.5948647707772913`*^9, {3.5948648441860847`*^9, 3.5948648482254267`*^9}, 
   3.5948673367099323`*^9, 3.594869441672271*^9, 3.615198461944812*^9}]
}, Open  ]],

Cell["You see.", "Text",
 CellChangeTimes->{{3.594869554791902*^9, 3.594869556639867*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Convert to matrix from a abstracted indeces quantity:", "Subsection",
 CellChangeTimes->{{3.594799041938995*^9, 3.5947990665143843`*^9}}],

Cell["\<\
This is extremely useful, thus important, since this will be done again and \
again during the process of calculation......see the \
\[OpenCurlyDoubleQuote]Remarks\[CloseCurlyDoubleQuote] below!\
\>", "Text",
 CellChangeTimes->{{3.594799072098524*^9, 3.5947990778587933`*^9}, {
  3.5947991950193663`*^9, 3.594799217954104*^9}, {3.5947992654422894`*^9, 
  3.59479930917684*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"generateMatrix", "[", 
  RowBox[{"einsteinTensor", ",", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i1", ",", "lo"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i2", ",", "lo"}], "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.594799083889179*^9, 3.594799109352682*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox[
        RowBox[{
         SuperscriptBox["a", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "2"]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"a", "[", "t", "]"}], " ", 
       RowBox[{
        SuperscriptBox["a", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}]}], ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox[
        RowBox[{
         SuperscriptBox["a", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "2"]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"a", "[", "t", "]"}], " ", 
       RowBox[{
        SuperscriptBox["a", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}]}], ",", "0", ",", "0"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox[
        RowBox[{
         SuperscriptBox["a", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "2"]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"a", "[", "t", "]"}], " ", 
       RowBox[{
        SuperscriptBox["a", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}]}], ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     FractionBox[
      RowBox[{"3", " ", 
       SuperscriptBox[
        RowBox[{
         SuperscriptBox["a", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.594799110327127*^9, 3.594800910251919*^9, 
  3.594803114356105*^9, 3.5948646730853043`*^9, 3.594867338608206*^9, 
  3.615198465742645*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.594799114991386*^9, 3.594799119157763*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["a", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "2"]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"a", "[", "t", "]"}], " ", 
        RowBox[{
         SuperscriptBox["a", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}], "0", "0", "0"},
     {"0", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["a", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "2"]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"a", "[", "t", "]"}], " ", 
        RowBox[{
         SuperscriptBox["a", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}], "0", "0"},
     {"0", "0", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["a", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "2"]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"a", "[", "t", "]"}], " ", 
        RowBox[{
         SuperscriptBox["a", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}], "0"},
     {"0", "0", "0", 
      FractionBox[
       RowBox[{"3", " ", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["a", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "2"]}], 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.594799119570723*^9, 3.59480091190337*^9, 
  3.594803115499279*^9, 3.594864673929763*^9, 3.594867339974886*^9, 
  3.615198467343423*^9}]
}, Open  ]],

Cell["Compare with the original matrix of Einstein tensor:", "Text",
 CellChangeTimes->{{3.59479915911871*^9, 3.594799179560587*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"einsteinTensorMatrix", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.594799129615098*^9, 3.5947991398903112`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["a", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "2"]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"a", "[", "t", "]"}], " ", 
        RowBox[{
         SuperscriptBox["a", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}], "0", "0", "0"},
     {"0", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["a", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "2"]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"a", "[", "t", "]"}], " ", 
        RowBox[{
         SuperscriptBox["a", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}], "0", "0"},
     {"0", "0", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["a", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "2"]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"a", "[", "t", "]"}], " ", 
        RowBox[{
         SuperscriptBox["a", "\[Prime]\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}]}], "0"},
     {"0", "0", "0", 
      FractionBox[
       RowBox[{"3", " ", 
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["a", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "2"]}], 
       SuperscriptBox[
        RowBox[{"a", "[", "t", "]"}], "2"]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.59479914026692*^9, 3.594800913446686*^9, 
  3.594803117259946*^9, 3.594864675853424*^9, 3.5948673419608583`*^9, 
  3.615198470029447*^9}]
}, Open  ]],

Cell["The same!", "Text",
 CellChangeTimes->{{3.5947991444746523`*^9, 3.5947991484746227`*^9}}],

Cell[CellGroupData[{

Cell["Note that the inverse process of this is quite simple:", "Subsubsection",
 CellChangeTimes->{{3.594799347168516*^9, 3.59479936327274*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "f", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i1_", ",", "lo"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"i2_", " ", ",", "lo"}], "}"}]}], "}"}], "]"}], " ", ":=", " ", 
   RowBox[{"metricMatrix", "[", 
    RowBox[{"[", 
     RowBox[{"i1", ",", "i2"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.594799366292385*^9, 3.5947994327486143`*^9}}],

Cell["\<\
Now, it\[CloseCurlyQuote]s been done! Quite simple, isn\[CloseCurlyQuote]t it?\
\>", "Text",
 CellChangeTimes->{{3.594799461168479*^9, 3.594799474670025*^9}}],

Cell["As you check this result by:", "Text",
 CellChangeTimes->{{3.5947994145045013`*^9, 3.594799416719655*^9}, {
  3.5947994800337343`*^9, 3.594799492991825*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"generateMatrix", "[", 
   RowBox[{"f", ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i1", ",", "lo"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"i2", ",", "lo"}], "}"}]}], "}"}]}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.594799439418943*^9, 3.594799447545608*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"], "0", "0", "0"},
     {"0", 
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"], "0", "0"},
     {"0", "0", 
      SuperscriptBox[
       RowBox[{"a", "[", "t", "]"}], "2"], "0"},
     {"0", "0", "0", 
      RowBox[{"-", "1"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.594799447999971*^9, 3.594800917907441*^9, 
  3.59480312551567*^9, 3.615198475318167*^9}]
}, Open  ]],

Cell["\<\
Just the original \[OpenCurlyDoubleQuote]metricMatrix\[CloseCurlyDoubleQuote]!\
\>", "Text",
 CellChangeTimes->{{3.594799503271948*^9, 3.5947995206799803`*^9}}]
}, Open  ]]
}, Open  ]],

Cell["Perturbations:", "Subsection",
 CellChangeTimes->{{3.5947995563751574`*^9, 3.5947995599030237`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Remarks", "Section",
 CellChangeTimes->{{3.575080862660659*^9, 3.5750808695964746`*^9}}],

Cell["\<\
All the indices used in the \[OpenCurlyDoubleQuote]For[]\
\[CloseCurlyDoubleQuote] cycle are marked by \[OpenCurlyDoubleQuote]X0\
\[CloseCurlyDoubleQuote], such as \[OpenCurlyDoubleQuote]i0\
\[CloseCurlyDoubleQuote], \
\[OpenCurlyDoubleQuote]j0\[CloseCurlyDoubleQuote],......\
\>", "Text",
 CellChangeTimes->{{3.575080875627738*^9, 3.575080951182612*^9}}],

Cell["\<\
Here\[CloseCurlyQuote]s an important thing. That is, when you calculate with \
the abstracted-indeces way, such as:
f[{{a_,lo}, {b_,lo}, {c_,lo}, {d_,up}, {e_,up}}] := \
Simplify[ajdsflksjadkfljjslfjskadjfklasjkldfjakldk], if the process of \
calculation of the RHS of the above definition of f with indices abstracted \
as the variables of the \[OpenCurlyDoubleQuote]function\
\[CloseCurlyDoubleQuote] f is extremely very complex, then it will spend a \
lot of time when every time you use the \[OpenCurlyDoubleQuote]function\
\[CloseCurlyDoubleQuote] f in other place such as: g = some combinations of \
such f.

I used to meet this case when I was calculating the perturbation of cosmology \
background. It\[CloseCurlyQuote]s quite horrible!! Believe it, or you can \
have a try while ensuring that you are not using a netbook but a awesome \
computer.

One efficient way of dealing with this terrible problem is keeping using both \
\[OpenCurlyDoubleQuote]matrix way\[CloseCurlyDoubleQuote] as well as \
\[OpenCurlyDoubleQuote]abstracted-indices way\[CloseCurlyDoubleQuote] by \
keeping translating a tensor from one side to another and vice versa.

The \[OpenCurlyDoubleQuote]matrix way\[CloseCurlyDoubleQuote] is faster for \
calculation, but harder for programming; while, the \
\[OpenCurlyDoubleQuote]abstracted-indices way\[CloseCurlyDoubleQuote] is good \
at programming but terrible for calculation when the expression becomes \
extremely complex.\
\>", "Text",
 CellChangeTimes->{{3.592300358150537*^9, 3.5923008607311287`*^9}, {
  3.592300906207799*^9, 3.592301165001112*^9}, {3.592301201119705*^9, 
  3.592301237305478*^9}, {3.594790538483924*^9, 3.5947905779780893`*^9}, {
  3.594798361225749*^9, 3.594798361327173*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1024, 600},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
Magnification:>FEPrivate`If[
  FEPrivate`Equal[FEPrivate`$VersionNumber, 6.], 1.25, 1.25 Inherited],
FrontEndVersion->"8.0 for Linux x86 (32-bit) (November 7, 2010)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 96, 1, 103, "Title"],
Cell[CellGroupData[{
Cell[700, 27, 99, 1, 87, "Section"],
Cell[802, 30, 503, 15, 131, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[1342, 50, 100, 1, 49, "Section"],
Cell[1445, 53, 705, 16, 103, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[2187, 74, 95, 1, 49, "Section"],
Cell[2285, 77, 716, 13, 152, "Text"],
Cell[3004, 92, 404, 7, 98, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[3445, 104, 154, 2, 49, "Section"],
Cell[CellGroupData[{
Cell[3624, 110, 132, 3, 57, "Subsection"],
Cell[3759, 115, 934, 21, 163, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4730, 141, 255, 5, 57, "Subsection"],
Cell[4988, 148, 2322, 72, 306, "Text"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[7359, 226, 92, 1, 49, "Section"],
Cell[CellGroupData[{
Cell[7476, 231, 120, 2, 46, "Subsection"],
Cell[7599, 235, 118, 2, 36, "Input"],
Cell[CellGroupData[{
Cell[7742, 241, 111, 1, 33, "Subsubsection"],
Cell[CellGroupData[{
Cell[7878, 246, 2728, 64, 271, "Input"],
Cell[10609, 312, 2627, 51, 119, "Output"]
}, Open  ]],
Cell[13251, 366, 1222, 17, 36, "Input"],
Cell[CellGroupData[{
Cell[14498, 387, 445, 8, 36, "Input"],
Cell[14946, 397, 3286, 77, 120, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18269, 479, 232, 5, 36, "Input"],
Cell[18504, 486, 3161, 80, 162, "Output"]
}, Open  ]],
Cell[21680, 569, 231, 5, 35, "Text"],
Cell[CellGroupData[{
Cell[21936, 578, 242, 4, 60, "Input"],
Cell[22181, 584, 2758, 71, 137, "Output"]
}, Open  ]],
Cell[24954, 658, 127, 2, 36, "Input"],
Cell[CellGroupData[{
Cell[25106, 664, 375, 10, 36, "Input"],
Cell[25484, 676, 803, 13, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26324, 694, 682, 18, 60, "Input"],
Cell[27009, 714, 885, 18, 62, "Output"],
Cell[27897, 734, 885, 18, 62, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[28843, 759, 100, 1, 46, "Subsection"],
Cell[28946, 762, 284, 5, 58, "Text"],
Cell[CellGroupData[{
Cell[29255, 771, 506, 12, 36, "Input"],
Cell[29764, 785, 424, 12, 53, "Output"]
}, Open  ]],
Cell[30203, 800, 416, 16, 43, "Text"],
Cell[CellGroupData[{
Cell[30644, 820, 555, 17, 36, "Input"],
Cell[31202, 839, 70, 1, 53, "Output"]
}, Open  ]],
Cell[31287, 843, 242, 8, 40, "Text"],
Cell[CellGroupData[{
Cell[31554, 855, 606, 18, 36, "Input"],
Cell[32163, 875, 573, 9, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32773, 889, 154, 2, 34, "Subsubsection"],
Cell[32930, 893, 401, 12, 43, "Text"],
Cell[33334, 907, 437, 12, 36, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[33820, 925, 110, 1, 46, "Subsection"],
Cell[33933, 928, 320, 10, 42, "Text"],
Cell[CellGroupData[{
Cell[34278, 942, 469, 11, 36, "Input"],
Cell[34750, 955, 1871, 38, 82, "Output"]
}, Open  ]],
Cell[36636, 996, 218, 8, 42, "Text"],
Cell[CellGroupData[{
Cell[36879, 1008, 569, 13, 36, "Input"],
Cell[37451, 1023, 1633, 34, 82, "Output"]
}, Open  ]],
Cell[39099, 1060, 353, 11, 42, "Text"],
Cell[CellGroupData[{
Cell[39477, 1075, 830, 20, 36, "Input"],
Cell[40310, 1097, 1272, 18, 53, "Output"]
}, Open  ]],
Cell[41597, 1118, 551, 15, 40, "Text"],
Cell[42151, 1135, 220, 8, 39, "Text"],
Cell[CellGroupData[{
Cell[42396, 1147, 439, 12, 36, "Input"],
Cell[42838, 1161, 1053, 25, 78, "Output"]
}, Open  ]],
Cell[43906, 1189, 475, 15, 40, "Text"],
Cell[CellGroupData[{
Cell[44406, 1208, 1788, 53, 107, "Input"],
Cell[46197, 1263, 449, 7, 53, "Output"]
}, Open  ]],
Cell[46661, 1273, 228, 5, 36, "Text"],
Cell[CellGroupData[{
Cell[46914, 1282, 991, 28, 60, "Input"],
Cell[47908, 1312, 354, 5, 53, "Output"]
}, Open  ]],
Cell[48277, 1320, 461, 13, 64, "Text"],
Cell[48741, 1335, 369, 6, 59, "Text"],
Cell[49113, 1343, 350, 6, 58, "Text"],
Cell[49466, 1351, 216, 8, 39, "Text"],
Cell[CellGroupData[{
Cell[49707, 1363, 175, 3, 36, "Input"],
Cell[49885, 1368, 1053, 32, 65, "Output"]
}, Open  ]],
Cell[50953, 1403, 242, 9, 39, "Text"],
Cell[CellGroupData[{
Cell[51220, 1416, 337, 8, 36, "Input"],
Cell[51560, 1426, 1059, 32, 65, "Output"]
}, Open  ]],
Cell[52634, 1461, 90, 1, 35, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52761, 1467, 143, 1, 46, "Subsection"],
Cell[52907, 1470, 387, 7, 58, "Text"],
Cell[CellGroupData[{
Cell[53319, 1481, 338, 9, 36, "Input"],
Cell[53660, 1492, 1890, 57, 89, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55587, 1554, 125, 2, 36, "Input"],
Cell[55715, 1558, 2203, 63, 120, "Output"]
}, Open  ]],
Cell[57933, 1624, 133, 1, 35, "Text"],
Cell[CellGroupData[{
Cell[58091, 1629, 146, 2, 36, "Input"],
Cell[58240, 1633, 2205, 63, 120, "Output"]
}, Open  ]],
Cell[60460, 1699, 95, 1, 35, "Text"],
Cell[CellGroupData[{
Cell[60580, 1704, 144, 1, 33, "Subsubsection"],
Cell[60727, 1707, 567, 17, 83, "Input"],
Cell[61297, 1726, 168, 3, 36, "Text"],
Cell[61468, 1731, 163, 2, 35, "Text"],
Cell[CellGroupData[{
Cell[61656, 1737, 368, 11, 36, "Input"],
Cell[62027, 1750, 974, 28, 102, "Output"]
}, Open  ]],
Cell[63016, 1781, 170, 3, 36, "Text"]
}, Open  ]]
}, Open  ]],
Cell[63213, 1788, 106, 1, 46, "Subsection"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63356, 1794, 94, 1, 87, "Section"],
Cell[63453, 1797, 365, 7, 36, "Text"],
Cell[63821, 1806, 1745, 31, 352, "Text"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
