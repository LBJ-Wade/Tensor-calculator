(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     48564,       1488]
NotebookOptionsPosition[     44101,       1331]
NotebookOutlinePosition[     44436,       1346]
CellTagsIndexPosition[     44393,       1343]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Back to Einstein\[CloseCurlyQuote]s Convension on Summation\
\>", "Title",
 CellChangeTimes->{{3.615201101570809*^9, 3.61520113022376*^9}, {
  3.615506434771691*^9, 3.615506438063548*^9}}],

Cell[CellGroupData[{

Cell["Principle", "Section",
 CellChangeTimes->{{3.615201238200147*^9, 3.615201242077688*^9}}],

Cell["Here we take the general assumption:", "Text",
 CellChangeTimes->{{3.61520113378807*^9, 3.615201143746388*^9}}],

Cell[TextData[StyleBox["The summation appears as long as there\
\[CloseCurlyQuote]s doubled index.",
 FontWeight->"Bold",
 FontSlant->"Italic"]], "Text",
 CellChangeTimes->{{3.615201153881552*^9, 3.615201188113144*^9}}],

Cell["This is our first principle!", "Text",
 CellChangeTimes->{{3.615201198663988*^9, 3.615201213816692*^9}}],

Cell[CellGroupData[{

Cell["Notes", "Subsection",
 CellChangeTimes->{{3.615505792126148*^9, 3.615505792803269*^9}}],

Cell["\<\
We use the colours to denotes the indices caused by the indices of \
coordinates.\
\>", "Text",
 CellChangeTimes->{{3.615506478663393*^9, 3.615506480205717*^9}, {
  3.615506517661788*^9, 3.615506557776355*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Lab", "Section",
 CellChangeTimes->{{3.615201222552089*^9, 3.615201226728668*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"colourOfDerivativeIndices", " ", "=", " ", "Red"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"colourOfIntrinsicIndices", " ", "=", " ", "Green"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.61550497635648*^9, 3.615505008760827*^9}, {
  3.615505188513633*^9, 3.615505207071123*^9}, {3.615511796287354*^9, 
  3.615511797937042*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"indicesColours", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "colourOfDerivativeIndices", ",", " ", "colourOfIntrinsicIndices"}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.615505133627283*^9, 3.6155051820804*^9}, {
  3.615516478466489*^9, 3.615516483973215*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"level", "[", 
    RowBox[{"expr_", ",", " ", 
     RowBox[{"order_:", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", "Infinity"}], "}"}]}]}], "]"}], " ", ":=", " ", 
   
   RowBox[{"Level", "[", 
    RowBox[{
     RowBox[{"FullForm", "@", "expr"}], ",", " ", "order"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"memberQ", "[", 
    RowBox[{"expr_", ",", " ", "listOfForms_", ",", " ", 
     RowBox[{"logic_:", "Or"}]}], "]"}], " ", ":=", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "@", "listOfForms"}], " ", "===", " ", "1"}], ",", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"MemberQ", "[", 
      RowBox[{"expr", ",", " ", 
       RowBox[{"listOfForms", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"logic", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"expr", ",", " ", 
         RowBox[{"listOfForms", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", " ", 
       RowBox[{"memberQ", "[", 
        RowBox[{"expr", ",", " ", 
         RowBox[{"Drop", "[", 
          RowBox[{"listOfForms", ",", " ", "1"}], "]"}], ",", " ", "logic"}], 
        "]"}]}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"indicesQ", "[", "subscripts_", "]"}], " ", ":=", 
   "\[IndentingNewLine]", "\t", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"memberQ", "[", 
       RowBox[{
        RowBox[{"level", "[", "subscripts", "]"}], ",", " ", 
        "indicesColours"}], "]"}], " ", "\[Equal]", " ", "True"}], ",", " ", 
     "True", ",", " ", "False"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.615505215067394*^9, 3.615505263183827*^9}, {
  3.615505304677908*^9, 3.61550539753909*^9}, {3.615505459876103*^9, 
  3.615505580399502*^9}, {3.615506600856012*^9, 3.615506670943743*^9}, {
  3.615506723710622*^9, 3.615506809524024*^9}, {3.61550684383816*^9, 
  3.61550686168229*^9}, {3.61550689892858*^9, 3.615506911700938*^9}, {
  3.615511690489049*^9, 3.615511712627164*^9}, {3.615516488096343*^9, 
  3.615516493210246*^9}, {3.615516565365276*^9, 3.615516569971846*^9}, {
  3.615516669635172*^9, 3.61551667236071*^9}, {3.615516797247238*^9, 
  3.615516800397743*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"g", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"x", ",", "y"}], "]"}], ",", 
     RowBox[{"{", "y", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.615200783850475*^9, 3.615200793244401*^9}, {
  3.615201877366887*^9, 3.615201879045711*^9}, {3.615201955988851*^9, 
  3.615201958104674*^9}, {3.615516803288898*^9, 3.615516804881798*^9}, {
  3.616311745692363*^9, 3.616311772551604*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Evaluate", "[", "g", "]"}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Derivative", "[", "indices__", "]"}], "[", "f_", "]"}], "[", 
     "coords__", "]"}], " ", "\[Rule]", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "f", "}"}], ",", " ", 
      RowBox[{"{", "indices", "}"}], ",", " ", 
      RowBox[{"{", "coords", "}"}]}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.615201282288808*^9, 3.615201433190297*^9}, {
  3.615201776996635*^9, 3.615201863725214*^9}, {3.61520196075839*^9, 
  3.6152019888452*^9}, {3.615202342443937*^9, 3.615202377040548*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "f", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.615201439135985*^9, {3.615201800528706*^9, 3.615201886817727*^9}, {
   3.615201961567926*^9, 3.615201993448996*^9}, 3.61520206953162*^9, {
   3.615202361170354*^9, 3.615202378251528*^9}, 3.615504897833963*^9, 
   3.615516518297596*^9, 3.615516808004532*^9, 3.616310957679151*^9, 
   3.616311775438345*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"g", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Derivative", "[", "indices__", "]"}], "[", "f_", "]"}], "[", 
     "coords__", "]"}], " ", "\[Rule]", " ", 
    RowBox[{
     RowBox[{"Subscript", "[", 
      RowBox[{"f", ",", " ", 
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{"List", "@", "indices"}], ",", "colourOfDerivativeIndices"}],
         "]"}]}], "]"}], "[", "coords", "]"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"h", " ", "=", " ", 
  RowBox[{"Evaluate", "@", "%"}]}]}], "Input",
 CellChangeTimes->{{3.615202008968687*^9, 3.615202049250539*^9}, {
  3.615202832591158*^9, 3.615202849573741*^9}, {3.615505017235194*^9, 
  3.615505020968556*^9}, {3.615516695430194*^9, 3.615516696583113*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["f", 
   StyleBox[
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}],
    StripOnInput->False,
    LineColor->RGBColor[1, 0, 0],
    FrontFaceColor->RGBColor[1, 0, 0],
    BackFaceColor->RGBColor[1, 0, 0],
    GraphicsColor->RGBColor[1, 0, 0],
    FontColor->RGBColor[1, 0, 0]]], "[", 
  RowBox[{"x", ",", "y"}], "]"}]], "Output",
 CellChangeTimes->{
  3.615202012705029*^9, {3.615202050203556*^9, 3.61520207106491*^9}, {
   3.615202839549428*^9, 3.615202850368858*^9}, 3.615504900992393*^9, 
   3.615516520216397*^9, {3.615516579563731*^9, 3.615516587464746*^9}, 
   3.615516697729369*^9, 3.615516809581437*^9, 3.616310960756915*^9, 
   3.616311788722943*^9}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["f", 
   StyleBox[
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}],
    StripOnInput->False,
    LineColor->RGBColor[1, 0, 0],
    FrontFaceColor->RGBColor[1, 0, 0],
    BackFaceColor->RGBColor[1, 0, 0],
    GraphicsColor->RGBColor[1, 0, 0],
    FontColor->RGBColor[1, 0, 0]]], "[", 
  RowBox[{"x", ",", "y"}], "]"}]], "Output",
 CellChangeTimes->{
  3.615202012705029*^9, {3.615202050203556*^9, 3.61520207106491*^9}, {
   3.615202839549428*^9, 3.615202850368858*^9}, 3.615504900992393*^9, 
   3.615516520216397*^9, {3.615516579563731*^9, 3.615516587464746*^9}, 
   3.615516697729369*^9, 3.615516809581437*^9, 3.616310960756915*^9, 
   3.616311789332923*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"level", "@", 
  RowBox[{"level", "@", "h"}]}]], "Input",
 CellChangeTimes->{{3.61551670345114*^9, 3.615516707351385*^9}, {
  3.615516845326204*^9, 3.615516846627991*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x", ",", "y", ",", "x", ",", "y", ",", 
   RowBox[{
    SubscriptBox["f", 
     StyleBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}],
      StripOnInput->False,
      LineColor->RGBColor[1, 0, 0],
      FrontFaceColor->RGBColor[1, 0, 0],
      BackFaceColor->RGBColor[1, 0, 0],
      GraphicsColor->RGBColor[1, 0, 0],
      FontColor->RGBColor[1, 0, 0]]], "[", 
    RowBox[{"x", ",", "y"}], "]"}], ",", "x", ",", "y", ",", 
   RowBox[{
    SubscriptBox["f", 
     StyleBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}],
      StripOnInput->False,
      LineColor->RGBColor[1, 0, 0],
      FrontFaceColor->RGBColor[1, 0, 0],
      BackFaceColor->RGBColor[1, 0, 0],
      GraphicsColor->RGBColor[1, 0, 0],
      FontColor->RGBColor[1, 0, 0]]], "[", 
    RowBox[{"x", ",", "y"}], "]"}], ",", 
   TagBox[
    StyleBox[
     RowBox[{
      RowBox[{"Subscript", "[", 
       RowBox[{"f", ",", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"List", "[", 
           RowBox[{"0", ",", "1"}], "]"}], ",", 
          RowBox[{"RGBColor", "[", 
           RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "]"}]}], "]"}], "[", 
      RowBox[{"x", ",", "y"}], "]"}],
     ShowSpecialCharacters->False,
     ShowStringCharacters->True,
     NumberMarks->True],
    FullForm], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", 
     RowBox[{
      SubscriptBox["f", 
       StyleBox[
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}],
        StripOnInput->False,
        LineColor->RGBColor[1, 0, 0],
        FrontFaceColor->RGBColor[1, 0, 0],
        BackFaceColor->RGBColor[1, 0, 0],
        GraphicsColor->RGBColor[1, 0, 0],
        FontColor->RGBColor[1, 0, 0]]], "[", 
      RowBox[{"x", ",", "y"}], "]"}], ",", 
     TagBox[
      StyleBox[
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"f", ",", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"List", "[", 
             RowBox[{"0", ",", "1"}], "]"}], ",", 
            RowBox[{"RGBColor", "[", 
             RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "]"}]}], "]"}], "[", 
        
        RowBox[{"x", ",", "y"}], "]"}],
       ShowSpecialCharacters->False,
       ShowStringCharacters->True,
       NumberMarks->True],
      FullForm]}], "}"}], ",", 
   TagBox[
    StyleBox[
     RowBox[{"List", "[", 
      RowBox[{"x", ",", "y", ",", 
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"f", ",", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"List", "[", 
             RowBox[{"0", ",", "1"}], "]"}], ",", 
            RowBox[{"RGBColor", "[", 
             RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "]"}]}], "]"}], "[", 
        
        RowBox[{"x", ",", "y"}], "]"}], ",", 
       RowBox[{"FullForm", "[", 
        RowBox[{
         RowBox[{"Subscript", "[", 
          RowBox[{"f", ",", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"List", "[", 
              RowBox[{"0", ",", "1"}], "]"}], ",", 
             RowBox[{"RGBColor", "[", 
              RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "]"}]}], "]"}], "[", 
         RowBox[{"x", ",", "y"}], "]"}], "]"}]}], "]"}],
     ShowSpecialCharacters->False,
     ShowStringCharacters->True,
     NumberMarks->True],
    FullForm]}], "}"}]], "Output",
 CellChangeTimes->{3.615516707907565*^9, 3.615516812836959*^9, 
  3.61551684733642*^9, 3.616310966866739*^9, 3.616311796040389*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"indicesQ", "@", "h"}]], "Input",
 CellChangeTimes->{{3.615516823011215*^9, 3.615516836528913*^9}}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{{3.615516837102361*^9, 3.61551685356334*^9}, 
   3.616310968744333*^9, 3.616311797892734*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"level", "@", "h"}]], "Input",
 CellChangeTimes->{{3.61551686927822*^9, 3.615516871433943*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x", ",", "y", ",", 
   RowBox[{
    SubscriptBox["f", 
     StyleBox[
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}],
      StripOnInput->False,
      LineColor->RGBColor[1, 0, 0],
      FrontFaceColor->RGBColor[1, 0, 0],
      BackFaceColor->RGBColor[1, 0, 0],
      GraphicsColor->RGBColor[1, 0, 0],
      FontColor->RGBColor[1, 0, 0]]], "[", 
    RowBox[{"x", ",", "y"}], "]"}], ",", 
   TagBox[
    StyleBox[
     RowBox[{
      RowBox[{"Subscript", "[", 
       RowBox[{"f", ",", 
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"List", "[", 
           RowBox[{"0", ",", "1"}], "]"}], ",", 
          RowBox[{"RGBColor", "[", 
           RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "]"}]}], "]"}], "[", 
      RowBox[{"x", ",", "y"}], "]"}],
     ShowSpecialCharacters->False,
     ShowStringCharacters->True,
     NumberMarks->True],
    FullForm]}], "}"}]], "Output",
 CellChangeTimes->{3.615516872072962*^9, 3.616310970906142*^9, 
  3.616311800234387*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Style", "[", 
   RowBox[{
    RowBox[{"List", "[", 
     RowBox[{"0", ",", "1"}], "]"}], ",", 
    RowBox[{"RGBColor", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "]"}], "//", 
  "indicesQ"}]], "Input",
 CellChangeTimes->{{3.615516526291666*^9, 3.615516531081048*^9}, {
  3.61551658290785*^9, 3.615516590164298*^9}, {3.615516646607212*^9, 
  3.615516648525472*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.615516590631725*^9, 3.615516649605312*^9, 
  3.616310973418422*^9, 3.616311801668773*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\"\<a\>\"", "//", "FullForm"}]], "Input",
 CellChangeTimes->{{3.615202432942644*^9, 3.615202458971307*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox["\"\<a\>\"",
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output",
 CellChangeTimes->{{3.615202434420945*^9, 3.615202459526428*^9}, 
   3.616310975647146*^9, 3.616311802778117*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"g", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", "indices__", "]"}], "[", "f_", "]"}], "[", 
      "coords__", "]"}], " ", "\[Rule]", " ", 
     RowBox[{
      RowBox[{"Subscript", "[", 
       RowBox[{"f", ",", " ", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<0,1\>\"", ",", "Red"}], "]"}]}], "]"}], "[", "coords", 
      "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "StandardForm"}]}], "Input",
 CellChangeTimes->{{3.6152029143431*^9, 3.615202944236544*^9}, {
   3.616311035334681*^9, 3.616311119087182*^9}, {3.61631131762259*^9, 
   3.616311374120923*^9}, 3.61631145169777*^9, {3.61631148179541*^9, 
   3.616311550589247*^9}, {3.616311812873473*^9, 3.616311863108365*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["f", 
   StyleBox["\<\"0,1\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0, 0],
    FrontFaceColor->RGBColor[1, 0, 0],
    BackFaceColor->RGBColor[1, 0, 0],
    GraphicsColor->RGBColor[1, 0, 0],
    FontColor->RGBColor[1, 0, 0]]], "[", 
  RowBox[{"x", ",", "y"}], "]"}]], "Output",
 CellChangeTimes->{{3.61520292414109*^9, 3.615202944659426*^9}, 
   3.616310978598577*^9, {3.6163110422973*^9, 3.616311120212888*^9}, {
   3.616311326311385*^9, 3.616311335551845*^9}, 3.6163113680694*^9, {
   3.616311466675232*^9, 3.616311551511818*^9}, {3.616311804114988*^9, 
   3.616311825879916*^9}, {3.616311856187902*^9, 3.616311864020404*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StandardForm", "[", 
  RowBox[{"g", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", "indices__", "]"}], "[", "f_", "]"}], "[", 
      "coords__", "]"}], " ", "\[Rule]", " ", 
     RowBox[{
      RowBox[{"Subscript", "[", 
       RowBox[{"f", ",", " ", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<0,1\>\"", ",", "Red"}], "]"}]}], "]"}], "[", "coords", 
      "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.616311174317592*^9, 3.616311189630759*^9}, {
   3.616311377079879*^9, 3.616311402262487*^9}, 3.616311460237523*^9}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["f", 
   StyleBox["\<\"0,1\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0, 0],
    FrontFaceColor->RGBColor[1, 0, 0],
    BackFaceColor->RGBColor[1, 0, 0],
    GraphicsColor->RGBColor[1, 0, 0],
    FontColor->RGBColor[1, 0, 0]]], "[", 
  RowBox[{"x", ",", "y"}], "]"}]], "Output",
 CellChangeTimes->{
  3.616311190390872*^9, {3.61631138287654*^9, 3.616311403014722*^9}, 
   3.616311477860089*^9, 3.616311829342109*^9, 3.616311866740495*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"eval", "[", "expr_", "]"}], " ", ":=", 
  RowBox[{"Evaluate", "@", 
   RowBox[{"Evaluate", "@", "expr"}]}]}]], "Input",
 CellChangeTimes->{{3.616311194313356*^9, 3.616311230956528*^9}, {
  3.616311266321462*^9, 3.616311306359294*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eval", "[", 
  RowBox[{"g", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", "indices__", "]"}], "[", "f_", "]"}], "[", 
      "coords__", "]"}], " ", "\[Rule]", " ", 
     RowBox[{
      RowBox[{"Subscript", "[", 
       RowBox[{"f", ",", " ", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<0,1\>\"", ",", "Red"}], "]"}]}], "]"}], "[", "coords", 
      "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.616311233610175*^9, 3.616311246167513*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   RowBox[{
    RowBox[{"Subscript", "[", 
     RowBox[{"f", ",", 
      RowBox[{"Style", "[", 
       RowBox[{"\"\<0,1\>\"", ",", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "]"}]}], "]"}], "[", 
    RowBox[{"x", ",", "y"}], "]"}],
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output",
 CellChangeTimes->{{3.616311298151968*^9, 3.616311308850136*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["ECoSForm[]", "Section",
 CellChangeTimes->{{3.61631010441513*^9, 3.616310118190491*^9}}],

Cell[CellGroupData[{

Cell["Strategy", "Subsection",
 CellChangeTimes->{{3.61631027890611*^9, 3.616310286422398*^9}}],

Cell[CellGroupData[{

Cell["\<\
Highlight the indices with respect to coordinates (default) and other \
quantities which you think are tensors;\
\>", "ItemNumbered",
 CellChangeTimes->{{3.616310320546276*^9, 3.616310376353618*^9}, {
  3.616310412498927*^9, 3.616310454816984*^9}, {3.616310766226951*^9, 
  3.616310809364485*^9}}],

Cell["\<\
convert the derivatives to the \[OpenCurlyQuote]standard\[CloseCurlyQuote] \
\[OpenCurlyQuote]indices form\[CloseCurlyQuote], and highlight it;\
\>", "ItemNumbered",
 CellChangeTimes->{{3.616310424177871*^9, 3.616310426877348*^9}, {
  3.616310460452939*^9, 3.616310472178786*^9}}],

Cell["\<\
replace the hightlighted indices with ECoS.\
\>", "ItemNumbered",
 CellChangeTimes->{{3.61631038273726*^9, 3.616310386168957*^9}, {
  3.616310466771235*^9, 3.616310486048731*^9}, {3.616310815147925*^9, 
  3.616310828409576*^9}}]
}, Open  ]],

Cell["For the 1st", "Subsection",
 CellChangeTimes->{{3.616580949025571*^9, 3.616580955213892*^9}}],

Cell[CellGroupData[{

Cell["quantityWithIndicesQ[quantity]", "Subsubsection",
 CellChangeTimes->{{3.616581586136718*^9, 3.616581592602336*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"quantityWithIndicesQ", "[", "quantityHead_", "]"}], " ", ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Head", "@", "quantityHead"}], " ", "=!=", " ", "Subscript"}], 
    ",", "\[IndentingNewLine]", "\t", "False", ",", "\[IndentingNewLine]", 
    "\t", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"Or", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"quantitiesWithIndicesList", ",", " ", "quantityHead"}], 
          "]"}], " ", "\[Equal]", " ", "True"}], ",", "\[IndentingNewLine]", 
        "\t\t", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"coordinates", ",", " ", "quantityHead"}], "]"}], " ", 
         "\[Equal]", " ", "True"}]}], "]"}], ",", "\[IndentingNewLine]", "\t",
       "True", ",", "\[IndentingNewLine]", "\t", "False"}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.616581053296007*^9, 3.616581064855552*^9}, {
  3.616581134552456*^9, 3.616581288228531*^9}, {3.61658138287432*^9, 
  3.616581536971875*^9}, {3.616647461255573*^9, 3.616647472443729*^9}}],

Cell[CellGroupData[{

Cell["Then we try:", "Text",
 CellChangeTimes->{{3.616581306058509*^9, 3.616581307871124*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dim", " ", "=", " ", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coordinates", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["x", "1"], ",", " ", 
     SubscriptBox["x", "2"], ",", " ", 
     SubscriptBox["x", "3"], ",", " ", "t"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.61658130910179*^9, 3.616581333317719*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"quantitiesWithIndicesList", " ", "=", " ", 
   RowBox[{"{", 
    SubscriptBox["Q", "1"], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.616581351157632*^9, 3.616581359074169*^9}, {
  3.616647184983901*^9, 3.616647186076042*^9}, {3.61664748025625*^9, 
  3.616647498692258*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"quantityWithIndicesQ", "[", 
  SubscriptBox["Q", "1"], "]"}]], "Input",
 CellChangeTimes->{{3.616581361816846*^9, 3.616581402725581*^9}, {
  3.616581550344407*^9, 3.616581555476134*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.61658139735967*^9, 3.616581404008788*^9}, {
   3.616581547261253*^9, 3.616581556151143*^9}, 3.616637859273412*^9, 
   3.616647188855141*^9, 3.61664750572589*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["highlightIndicesOfQuantities[expr]", "Subsubsection",
 CellChangeTimes->{{3.616581639181453*^9, 3.616581658387116*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"highlightIndicesOfQuantities", "[", "expr_", "]"}], " ", ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"result", ",", " ", "quantity", ",", " ", "indices"}], "}"}], 
    ",", "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"result", " ", "=", " ", 
      RowBox[{"ReplaceAll", "[", 
       RowBox[{"expr", ",", " ", "\[IndentingNewLine]", "\t\t\t\t", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Subscript", "[", 
           RowBox[{"quantity_", ",", "indices__"}], "]"}], " ", ":>", 
          "\[IndentingNewLine]", "\t\t\t\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"quantityWithIndicesQ", "[", 
              RowBox[{"Subscript", "[", 
               RowBox[{"quantity", ",", "indices"}], "]"}], "]"}], " ", 
             "\[Equal]", " ", "True"}], ",", "\[IndentingNewLine]", 
            "\t\t\t\t\t\t", 
            RowBox[{"Subscript", "[", 
             RowBox[{"quantity", ",", " ", 
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"ToString", "@", "indices"}], ",", " ", "Red"}], 
               "]"}]}], "]"}], ",", "\[IndentingNewLine]", "\t\t\t\t\t\t", 
            RowBox[{"Subscript", "[", 
             RowBox[{"quantity", ",", "indices"}], "]"}]}], "]"}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Return", "@", "result"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.616581659771142*^9, 3.61658169712478*^9}, {
   3.616637277827378*^9, 3.616637632106888*^9}, {3.616637911652873*^9, 
   3.616637912512993*^9}, {3.616637958240988*^9, 3.61663796650695*^9}, {
   3.616638275845057*^9, 3.616638368031512*^9}, {3.616638455354458*^9, 
   3.616638455703016*^9}, 3.616647117131993*^9, {3.616647156088618*^9, 
   3.616647157515751*^9}, {3.616647271948525*^9, 3.616647388526273*^9}, {
   3.616647430618617*^9, 3.616647436252069*^9}, {3.616665204837804*^9, 
   3.61666520779207*^9}}],

Cell["\<\
But, this function will highlight all the indices of coordinates including \
the ones as variables.\
\>", "Text",
 CellChangeTimes->{{3.616665226964573*^9, 3.616665386729277*^9}, {
  3.616666320030738*^9, 3.616666370035201*^9}}],

Cell[CellGroupData[{

Cell["Here we try:", "Text",
 CellChangeTimes->{{3.616647132209071*^9, 3.616647134628056*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"f", " ", 
   SubscriptBox["x", "1"]}], "//", "highlightIndicesOfQuantities"}]], "Input",\

 CellChangeTimes->{{3.616647140591868*^9, 3.616647201143924*^9}}],

Cell[BoxData[
 RowBox[{"f", " ", 
  SubscriptBox["x", 
   StyleBox["\<\"1\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0, 0],
    FrontFaceColor->RGBColor[1, 0, 0],
    BackFaceColor->RGBColor[1, 0, 0],
    GraphicsColor->RGBColor[1, 0, 0],
    FontColor->RGBColor[1, 0, 0]]]}]], "Output",
 CellChangeTimes->{{3.616647176495338*^9, 3.616647201570257*^9}, 
   3.616647394112985*^9, 3.616647443982081*^9, 3.61664751079863*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["Q", "1"], " ", 
   SubscriptBox["x", "1"]}], "//", "highlightIndicesOfQuantities"}]], "Input",\

 CellChangeTimes->{{3.616647208912184*^9, 3.616647211232148*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["Q", 
   StyleBox["\<\"1\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0, 0],
    FrontFaceColor->RGBColor[1, 0, 0],
    BackFaceColor->RGBColor[1, 0, 0],
    GraphicsColor->RGBColor[1, 0, 0],
    FontColor->RGBColor[1, 0, 0]]], " ", 
  SubscriptBox["x", 
   StyleBox["\<\"1\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0, 0],
    FrontFaceColor->RGBColor[1, 0, 0],
    BackFaceColor->RGBColor[1, 0, 0],
    GraphicsColor->RGBColor[1, 0, 0],
    FontColor->RGBColor[1, 0, 0]]]}]], "Output",
 CellChangeTimes->{3.61664721308992*^9, 3.616647395149438*^9, 
  3.616647445148571*^9, 3.616647511870539*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    SubscriptBox["Q", "1"], "[", "t", "]"}], " ", 
   SubscriptBox["x", "1"]}], "//", "highlightIndicesOfQuantities"}]], "Input",\

 CellChangeTimes->{{3.616647363147591*^9, 3.616647367086033*^9}, {
  3.616647410862151*^9, 3.616647424998766*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["x", 
   StyleBox["\<\"1\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0, 0],
    FrontFaceColor->RGBColor[1, 0, 0],
    BackFaceColor->RGBColor[1, 0, 0],
    GraphicsColor->RGBColor[1, 0, 0],
    FontColor->RGBColor[1, 0, 0]]], " ", 
  RowBox[{
   SubscriptBox["Q", 
    StyleBox["\<\"1\"\>",
     StripOnInput->False,
     LineColor->RGBColor[1, 0, 0],
     FrontFaceColor->RGBColor[1, 0, 0],
     BackFaceColor->RGBColor[1, 0, 0],
     GraphicsColor->RGBColor[1, 0, 0],
     FontColor->RGBColor[1, 0, 0]]], "[", "t", "]"}]}]], "Output",
 CellChangeTimes->{{3.616647368120229*^9, 3.616647415522151*^9}, 
   3.616647446326234*^9, 3.616647513031876*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["For the 2nd", "Subsection",
 CellChangeTimes->{{3.616580825042057*^9, 3.616580836992549*^9}, 
   3.616580958248724*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"highlightIndicesOfDerivatives", "[", "expr_", "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"result", ",", "indices", ",", "f", ",", "coords"}], "}"}], ",",
      "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "replace", " ", "the", " ", "derivatives", " ", "on", " ", "the", " ", 
       "supscript", " ", "to", " ", "the", " ", "standard", " ", "ECoS", " ", 
       
       RowBox[{"form", "."}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"result", " ", "=", " ", 
       RowBox[{"ReplaceAll", "[", 
        RowBox[{"expr", ",", 
         RowBox[{"{", 
          RowBox[{
           StyleBox[
            RowBox[{
             RowBox[{
              RowBox[{"Derivative", "[", "indices__", "]"}], "[", "f_", "]"}],
              "[", "coords__", "]"}],
            ShowSpecialCharacters->False,
            ShowStringCharacters->True,
            NumberMarks->True], 
           StyleBox[" ",
            ShowSpecialCharacters->False,
            ShowStringCharacters->True,
            NumberMarks->True], 
           StyleBox[":>",
            ShowSpecialCharacters->False,
            ShowStringCharacters->True,
            NumberMarks->True], 
           StyleBox["  ",
            ShowSpecialCharacters->False,
            ShowStringCharacters->True,
            NumberMarks->True], 
           RowBox[{
            RowBox[{"Subscript", "[", 
             RowBox[{"f", ",", " ", 
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{"indicesStringOfDerivatives", "[", 
                 RowBox[{"List", "[", "indices", "]"}], "]"}], ",", "Red"}], 
               "]"}]}], "]"}], "[", "coords", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"Return", "@", "result"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"indicesStringOfDerivatives", "[", "indicesList_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"result", "=", "\"\<\>\""}], ",", "i1", ",", "i2"}], "}"}], ",",
     "\[IndentingNewLine]", "\t", 
    RowBox[{"(*", " ", 
     RowBox[{"sub", "-", 
      RowBox[{"function", " ", "of", " ", 
       RowBox[{
        RowBox[{"highlightIndicesOfDerivatives", "[", "expr", "]"}], ".", 
        "\[IndentingNewLine]", "\t", "replace"}], " ", "a", " ", "indices"}], 
      "-", 
      RowBox[{
      "list", " ", "to", " ", "the", " ", "standard", " ", "ECoS", " ", 
       RowBox[{"form", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i1", "=", "1"}], ",", " ", 
       RowBox[{"i1", "\[LessEqual]", "dim"}], ",", " ", 
       RowBox[{"i1", "++"}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"indicesList", "[", 
           RowBox[{"[", "i1", "]"}], "]"}], " ", "=!=", " ", "0"}], ",", 
         "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i2", "=", "1"}], ",", " ", 
           RowBox[{"i2", "<=", 
            RowBox[{"indicesList", "[", 
             RowBox[{"[", "i1", "]"}], "]"}]}], ",", " ", 
           RowBox[{"i2", "++"}], ",", "\[IndentingNewLine]", "\t\t\t\t", 
           RowBox[{"result", " ", "=", " ", 
            RowBox[{"result", "<>", "\"\<,\>\"", "<>", 
             RowBox[{"ToString", "[", "i1", "]"}]}]}]}], "]"}]}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Return", "@", "result"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.616574998041013*^9, 3.616575114798487*^9}, {
  3.61658038083352*^9, 3.616580381235231*^9}, {3.616580464188916*^9, 
  3.616580513645095*^9}, {3.616580565034937*^9, 3.616580798747844*^9}, {
  3.616580996924728*^9, 3.616581000789016*^9}}],

Cell[CellGroupData[{

Cell["Then we try:", "Text",
 CellChangeTimes->{{3.616312126619372*^9, 3.616312152619848*^9}, {
   3.616312244648195*^9, 3.61631225551628*^9}, {3.616312310075343*^9, 
   3.616312366378635*^9}, 3.616312507402762*^9, {3.616312630684158*^9, 
   3.616312632138321*^9}, {3.616312665908268*^9, 3.616312776715964*^9}, {
   3.616312827171614*^9, 3.616312969926572*^9}, {3.616313027851344*^9, 
   3.61631311873376*^9}, {3.616313157753362*^9, 3.616313162895046*^9}, 
   3.616313753960236*^9, 3.61658056303206*^9, {3.616580805738398*^9, 
   3.616580814426242*^9}, {3.616580870576596*^9, 3.616580871371098*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dim", "=", "4"}], ";"}]], "Input",
 CellChangeTimes->{{3.61657483692589*^9, 3.616574839511126*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"g", "=", 
  RowBox[{"Evaluate", "[", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "2"}], "}"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.616313373733048*^9, 3.616313375060112*^9}, 
   3.616313572350883*^9}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["f", 
   TagBox[
    RowBox[{"(", 
     RowBox[{"2", ",", "0", ",", "0", ",", "0"}], ")"}],
    Derivative],
   MultilineFunction->None], "[", 
  RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.616313378869797*^9, {3.616313553338996*^9, 3.616313572356871*^9}, 
   3.616574769807066*^9, 3.616575090356037*^9, 3.616580046784534*^9, 
   3.616580384850769*^9, 3.616649857682346*^9}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["f", 
   TagBox[
    RowBox[{"(", 
     RowBox[{"2", ",", "0", ",", "0", ",", "0"}], ")"}],
    Derivative],
   MultilineFunction->None], "[", 
  RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.616313378869797*^9, {3.616313553338996*^9, 3.616313572356871*^9}, 
   3.616574769807066*^9, 3.616575090356037*^9, 3.616580046784534*^9, 
   3.616580384850769*^9}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["f", 
   TagBox[
    RowBox[{"(", 
     RowBox[{"2", ",", "0", ",", "0", ",", "0"}], ")"}],
    Derivative],
   MultilineFunction->None], "[", 
  RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.616313378869797*^9, {3.616313553338996*^9, 3.616313572356871*^9}, 
   3.616574769807066*^9, 3.616575090356037*^9, 3.616580046784534*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"indicesStringOfDerivatives", "[", 
  RowBox[{"{", 
   RowBox[{"2", ",", "0", ",", "0", ",", "0"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.616574893749876*^9, 3.616574904219456*^9}}],

Cell[BoxData[
 RowBox[{"indicesStringOfDerivatives", "[", 
  RowBox[{"{", 
   RowBox[{"2", ",", "0", ",", "0", ",", "0"}], "}"}], "]"}]], "Output",
 CellChangeTimes->{3.61657490481184*^9, 3.616575093362182*^9, 
  3.616580060965291*^9, 3.616580387130192*^9, 3.616649860548885*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"highlightIndicesOfDerivatives", "@", "g", "     "}]], "Input",
 CellChangeTimes->{{3.616313169754571*^9, 3.616313189028048*^9}, 
   3.616581011868408*^9, {3.61665740119684*^9, 3.616657402389496*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["f", 
   StyleBox["\<\",1,1\"\>",
    StripOnInput->False,
    LineColor->RGBColor[1, 0, 0],
    FrontFaceColor->RGBColor[1, 0, 0],
    BackFaceColor->RGBColor[1, 0, 0],
    GraphicsColor->RGBColor[1, 0, 0],
    FontColor->RGBColor[1, 0, 0]]], "[", 
  RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]], "Output",
 CellChangeTimes->{
  3.616574795576458*^9, 3.616574863680197*^9, {3.616575096162272*^9, 
   3.616575172294989*^9}, 3.616575237914106*^9, {3.616580063917356*^9, 
   3.61658007486038*^9}, 3.61658038861527*^9, 3.616581013052508*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"highlightIndicesForm", "[", "expr_", "]"}], " ", ":=", " ", 
   RowBox[{"highlightIndicesOfQuantities", "@", 
    RowBox[{"highlightIndicesOfDerivatives", "@", "expr"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.616649753549624*^9, 3.616649829144667*^9}}],

Cell["Here we try:", "Text",
 CellChangeTimes->{{3.616657539586593*^9, 3.616657541696919*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expr", " ", "=", " ", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     SubscriptBox["x", "i"], " ", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{
         SubscriptBox["x", "1"], ",", 
         SubscriptBox["x", "2"], ",", 
         SubscriptBox["x", "3"], ",", "t"}], "]"}], ",", 
       SubscriptBox["x", "i"]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "dim"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.616657524199371*^9, 3.616657530396697*^9}, {
  3.616657586648771*^9, 3.616657633229337*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["x", "3"], " ", 
   RowBox[{
    SuperscriptBox["f", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{
     SubscriptBox["x", "1"], ",", 
     SubscriptBox["x", "2"], ",", 
     SubscriptBox["x", "3"], ",", "t"}], "]"}]}], "+", 
  RowBox[{
   SubscriptBox["x", "2"], " ", 
   RowBox[{
    SuperscriptBox["f", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{
     SubscriptBox["x", "1"], ",", 
     SubscriptBox["x", "2"], ",", 
     SubscriptBox["x", "3"], ",", "t"}], "]"}]}], "+", 
  RowBox[{
   SubscriptBox["x", "1"], " ", 
   RowBox[{
    SuperscriptBox["f", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{
     SubscriptBox["x", "1"], ",", 
     SubscriptBox["x", "2"], ",", 
     SubscriptBox["x", "3"], ",", "t"}], "]"}]}]}]], "Output",
 CellChangeTimes->{3.616657635476257*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"exprWithIndicesHighlighted", " ", "=", " ", 
  RowBox[{"expr", "//", "highlightIndicesForm"}]}]], "Input",
 CellChangeTimes->{{3.616657655159327*^9, 3.616657680792691*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["x", 
    StyleBox["\<\"1\"\>",
     StripOnInput->False,
     LineColor->RGBColor[1, 0, 0],
     FrontFaceColor->RGBColor[1, 0, 0],
     BackFaceColor->RGBColor[1, 0, 0],
     GraphicsColor->RGBColor[1, 0, 0],
     FontColor->RGBColor[1, 0, 0]]], " ", 
   RowBox[{
    SubscriptBox["f", 
     StyleBox["\<\",1\"\>",
      StripOnInput->False,
      LineColor->RGBColor[1, 0, 0],
      FrontFaceColor->RGBColor[1, 0, 0],
      BackFaceColor->RGBColor[1, 0, 0],
      GraphicsColor->RGBColor[1, 0, 0],
      FontColor->RGBColor[1, 0, 0]]], "[", 
    RowBox[{
     SubscriptBox["x", 
      StyleBox["\<\"1\"\>",
       StripOnInput->False,
       LineColor->RGBColor[1, 0, 0],
       FrontFaceColor->RGBColor[1, 0, 0],
       BackFaceColor->RGBColor[1, 0, 0],
       GraphicsColor->RGBColor[1, 0, 0],
       FontColor->RGBColor[1, 0, 0]]], ",", 
     SubscriptBox["x", 
      StyleBox["\<\"2\"\>",
       StripOnInput->False,
       LineColor->RGBColor[1, 0, 0],
       FrontFaceColor->RGBColor[1, 0, 0],
       BackFaceColor->RGBColor[1, 0, 0],
       GraphicsColor->RGBColor[1, 0, 0],
       FontColor->RGBColor[1, 0, 0]]], ",", 
     SubscriptBox["x", 
      StyleBox["\<\"3\"\>",
       StripOnInput->False,
       LineColor->RGBColor[1, 0, 0],
       FrontFaceColor->RGBColor[1, 0, 0],
       BackFaceColor->RGBColor[1, 0, 0],
       GraphicsColor->RGBColor[1, 0, 0],
       FontColor->RGBColor[1, 0, 0]]], ",", "t"}], "]"}]}], "+", 
  RowBox[{
   SubscriptBox["x", 
    StyleBox["\<\"2\"\>",
     StripOnInput->False,
     LineColor->RGBColor[1, 0, 0],
     FrontFaceColor->RGBColor[1, 0, 0],
     BackFaceColor->RGBColor[1, 0, 0],
     GraphicsColor->RGBColor[1, 0, 0],
     FontColor->RGBColor[1, 0, 0]]], " ", 
   RowBox[{
    SubscriptBox["f", 
     StyleBox["\<\",2\"\>",
      StripOnInput->False,
      LineColor->RGBColor[1, 0, 0],
      FrontFaceColor->RGBColor[1, 0, 0],
      BackFaceColor->RGBColor[1, 0, 0],
      GraphicsColor->RGBColor[1, 0, 0],
      FontColor->RGBColor[1, 0, 0]]], "[", 
    RowBox[{
     SubscriptBox["x", 
      StyleBox["\<\"1\"\>",
       StripOnInput->False,
       LineColor->RGBColor[1, 0, 0],
       FrontFaceColor->RGBColor[1, 0, 0],
       BackFaceColor->RGBColor[1, 0, 0],
       GraphicsColor->RGBColor[1, 0, 0],
       FontColor->RGBColor[1, 0, 0]]], ",", 
     SubscriptBox["x", 
      StyleBox["\<\"2\"\>",
       StripOnInput->False,
       LineColor->RGBColor[1, 0, 0],
       FrontFaceColor->RGBColor[1, 0, 0],
       BackFaceColor->RGBColor[1, 0, 0],
       GraphicsColor->RGBColor[1, 0, 0],
       FontColor->RGBColor[1, 0, 0]]], ",", 
     SubscriptBox["x", 
      StyleBox["\<\"3\"\>",
       StripOnInput->False,
       LineColor->RGBColor[1, 0, 0],
       FrontFaceColor->RGBColor[1, 0, 0],
       BackFaceColor->RGBColor[1, 0, 0],
       GraphicsColor->RGBColor[1, 0, 0],
       FontColor->RGBColor[1, 0, 0]]], ",", "t"}], "]"}]}], "+", 
  RowBox[{
   SubscriptBox["x", 
    StyleBox["\<\"3\"\>",
     StripOnInput->False,
     LineColor->RGBColor[1, 0, 0],
     FrontFaceColor->RGBColor[1, 0, 0],
     BackFaceColor->RGBColor[1, 0, 0],
     GraphicsColor->RGBColor[1, 0, 0],
     FontColor->RGBColor[1, 0, 0]]], " ", 
   RowBox[{
    SubscriptBox["f", 
     StyleBox["\<\",3\"\>",
      StripOnInput->False,
      LineColor->RGBColor[1, 0, 0],
      FrontFaceColor->RGBColor[1, 0, 0],
      BackFaceColor->RGBColor[1, 0, 0],
      GraphicsColor->RGBColor[1, 0, 0],
      FontColor->RGBColor[1, 0, 0]]], "[", 
    RowBox[{
     SubscriptBox["x", 
      StyleBox["\<\"1\"\>",
       StripOnInput->False,
       LineColor->RGBColor[1, 0, 0],
       FrontFaceColor->RGBColor[1, 0, 0],
       BackFaceColor->RGBColor[1, 0, 0],
       GraphicsColor->RGBColor[1, 0, 0],
       FontColor->RGBColor[1, 0, 0]]], ",", 
     SubscriptBox["x", 
      StyleBox["\<\"2\"\>",
       StripOnInput->False,
       LineColor->RGBColor[1, 0, 0],
       FrontFaceColor->RGBColor[1, 0, 0],
       BackFaceColor->RGBColor[1, 0, 0],
       GraphicsColor->RGBColor[1, 0, 0],
       FontColor->RGBColor[1, 0, 0]]], ",", 
     SubscriptBox["x", 
      StyleBox["\<\"3\"\>",
       StripOnInput->False,
       LineColor->RGBColor[1, 0, 0],
       FrontFaceColor->RGBColor[1, 0, 0],
       BackFaceColor->RGBColor[1, 0, 0],
       GraphicsColor->RGBColor[1, 0, 0],
       FontColor->RGBColor[1, 0, 0]]], ",", "t"}], "]"}]}]}]], "Output",
 CellChangeTimes->{3.616657681785926*^9}]
}, Open  ]],

Cell["Thus, modulize as", "Text",
 CellChangeTimes->{{3.6166575444224*^9, 3.616657563953025*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ECoSForm", "[", "expr_", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"exprWithIndicesHighlighted", " ", "=", " ", 
      RowBox[{"highlightIndicesForm", "@", "expr"}]}], ";"}]}], 
   "\[IndentingNewLine]", "\t", "]"}]}]], "Input",
 CellChangeTimes->{{3.616310122155709*^9, 3.616310137389686*^9}, {
  3.61665742991508*^9, 3.616657480336174*^9}}],

Cell[BoxData[
 RowBox[{"replaceIndices", "[", "]"}]], "Input",
 CellChangeTimes->{{3.61631023904201*^9, 3.61631024403568*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1024, 600},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"8.0 for Linux x86 (32-bit) (November 7, 2010)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 198, 4, 83, "Title"],
Cell[CellGroupData[{
Cell[802, 30, 94, 1, 72, "Section"],
Cell[899, 33, 117, 1, 30, "Text"],
Cell[1019, 36, 219, 4, 30, "Text"],
Cell[1241, 42, 110, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[1376, 47, 93, 1, 37, "Subsection"],
Cell[1472, 50, 220, 5, 30, "Text"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[1741, 61, 88, 1, 42, "Section"],
Cell[1832, 64, 379, 9, 50, "Input"],
Cell[2214, 75, 314, 8, 30, "Input"],
Cell[2531, 85, 2376, 60, 167, "Input"],
Cell[4910, 147, 474, 11, 30, "Input"],
Cell[CellGroupData[{
Cell[5409, 162, 642, 16, 30, "Input"],
Cell[6054, 180, 535, 13, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6626, 198, 787, 20, 69, "Input"],
Cell[7416, 220, 703, 18, 32, "Output"],
Cell[8122, 240, 703, 18, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8862, 263, 194, 4, 30, "Input"],
Cell[9059, 269, 3515, 105, 90, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12611, 379, 122, 2, 30, "Input"],
Cell[12736, 383, 145, 2, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12918, 390, 118, 2, 30, "Input"],
Cell[13039, 394, 1034, 32, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14110, 431, 411, 11, 30, "Input"],
Cell[14524, 444, 142, 2, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14703, 451, 131, 2, 30, "Input"],
Cell[14837, 455, 271, 8, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15145, 468, 800, 19, 50, "Input"],
Cell[15948, 489, 683, 15, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16668, 509, 616, 16, 30, "Input"],
Cell[17287, 527, 492, 13, 30, "Output"]
}, Open  ]],
Cell[17794, 543, 269, 6, 30, "Input"],
Cell[CellGroupData[{
Cell[18088, 553, 536, 15, 30, "Input"],
Cell[18627, 570, 488, 15, 30, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[19164, 591, 94, 1, 42, "Section"],
Cell[CellGroupData[{
Cell[19283, 596, 95, 1, 37, "Subsection"],
Cell[CellGroupData[{
Cell[19403, 601, 307, 6, 24, "ItemNumbered"],
Cell[19713, 609, 290, 5, 24, "ItemNumbered"],
Cell[20006, 616, 238, 5, 24, "ItemNumbered"]
}, Open  ]],
Cell[20259, 624, 99, 1, 37, "Subsection"],
Cell[CellGroupData[{
Cell[20383, 629, 121, 1, 22, "Subsubsection"],
Cell[20507, 632, 1142, 27, 150, "Input"],
Cell[CellGroupData[{
Cell[21674, 663, 94, 1, 30, "Text"],
Cell[21771, 666, 393, 10, 50, "Input"],
Cell[22167, 678, 312, 7, 30, "Input"],
Cell[CellGroupData[{
Cell[22504, 689, 210, 4, 30, "Input"],
Cell[22717, 695, 215, 3, 30, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[22993, 705, 125, 1, 28, "Subsubsection"],
Cell[23121, 708, 2033, 43, 170, "Input"],
Cell[25157, 753, 238, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[25420, 762, 94, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[25539, 767, 191, 5, 30, "Input"],
Cell[25733, 774, 437, 11, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26207, 790, 214, 6, 30, "Input"],
Cell[26424, 798, 664, 19, 30, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[27149, 824, 293, 8, 30, "Input"],
Cell[27445, 834, 704, 20, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28186, 859, 125, 2, 37, "Subsection"],
Cell[28314, 863, 4007, 99, 383, "Input"],
Cell[CellGroupData[{
Cell[32346, 966, 599, 8, 30, "Text"],
Cell[32948, 976, 134, 3, 30, "Input"],
Cell[CellGroupData[{
Cell[33107, 983, 361, 10, 30, "Input"],
Cell[33471, 995, 508, 14, 30, "Output"],
Cell[33982, 1011, 486, 14, 30, "Output"],
Cell[34471, 1027, 460, 13, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34968, 1045, 212, 4, 30, "Input"],
Cell[35183, 1051, 279, 5, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35499, 1061, 223, 3, 30, "Input"],
Cell[35725, 1066, 584, 14, 30, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[36382, 1088, 22, 0, 37, "Subsection"],
Cell[36407, 1090, 306, 7, 30, "Input"],
Cell[36716, 1099, 94, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[36835, 1104, 598, 17, 30, "Input"],
Cell[37436, 1123, 1176, 41, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38649, 1169, 196, 3, 30, "Input"],
Cell[38848, 1174, 4464, 131, 30, "Output"]
}, Open  ]],
Cell[43327, 1308, 97, 1, 30, "Text"],
Cell[43427, 1311, 505, 11, 90, "Input"],
Cell[43935, 1324, 126, 2, 30, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
